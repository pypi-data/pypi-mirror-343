import{D2 as l}from"https://esm.sh/@terrastruct/d2@0.1.23";var m="index";async function f(t,o,e){let n=await t.compile(o,{options:e,inputPath:m});return await t.render(n.diagram,{...n.renderOptions,...e})}var y=()=>{let t=new l,o=!1;return{async render({model:e,el:n}){let i=()=>e.get("diagram"),d=()=>e.get("options"),g=r=>{e.set("_svg",r),e.save_changes()},a=()=>{let r=n.firstChild;if(!r)throw new Error("Root element not found");return r},s=async()=>{if(o){console.log("Another update is already in progress, skipping");return}o=!0;try{let r=await f(t,i(),d());g(r),a().innerHTML=r}catch(r){console.error(r);let p=r instanceof Error?r.message:"Unknown error";a().innerHTML=`<div class="error">Error generating diagram: ${p}</div>`}o=!1},c=document.createElement("div");n.appendChild(c),n.classList.add("d2-widget"),e.on("change:diagram",s),e.on("change:options",s),await s()}}};export{y as default};
