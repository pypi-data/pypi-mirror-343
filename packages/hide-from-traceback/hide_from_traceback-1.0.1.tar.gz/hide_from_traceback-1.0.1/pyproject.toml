[project]
name = "hide_from_traceback"
description = "Omit utility functions from tracebacks."
version = "1.0.1"
requires-python = ">= 3.9"
readme = "README.md"
license-files = ["LICENSE"]
dependencies = ["typing-extensions >= 4.4.0; python_version < '3.10'"]

[project.urls]
Repository = "https://github.com/emosenkis/hide_from_traceback"

[build-system]
requires = ["setuptools >= 61.0", "this-package-requires-cpython; implementation_name != 'cpython'"]
build-backend = "setuptools.build_meta"

[tool.setuptools]
ext-modules = [{ name ="_hide_from_traceback", sources = ["lib.c"] }]
packages = ["hide_from_traceback", "_hide_from_traceback"]

[tool.cibuildwheel]
build = "cp39-* cp310-* cp311-* cp312-* cp313-*"
test-requires = ["mypy==1.15.0"]
# Don't run mypy under Python 3.13 - it errors out with "extension module 'mypy.nodes' is already cached"
test-command = "cd {project} && python -m doctest hide_from_traceback/__init__.py && (python -c $'import sys\nif sys.version_info < (3, 13): sys.exit(1)' || mypy --strict hide_from_traceback)"

[tool.cibuildwheel.windows]
# Tests and mypy are currently failing on Windows, possibly because of the use of / instead of \ in paths.
test-command = ""
