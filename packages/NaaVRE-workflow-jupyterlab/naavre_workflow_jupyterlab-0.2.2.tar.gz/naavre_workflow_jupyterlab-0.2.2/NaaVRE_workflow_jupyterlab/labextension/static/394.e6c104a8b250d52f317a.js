"use strict";(self.webpackChunk_naavre_workflow_jupyterlab=self.webpackChunk_naavre_workflow_jupyterlab||[]).push([[394],{8394:(e,t,n)=>{n.r(t),n.d(t,{IWorkflowTracker:()=>et,default:()=>nt});var r=n(85),a=n(1611),l=n(7594),i=n(2625),s=n(7262),o=n(8612),c=n(5828),d=n(1623),p=n(7081),h=n(4602),u=n(1079),m=n.n(u),g=n(3345),f=n.n(g),y=n(2515),w=n(8856),v=n(1918),x=n(9335),k=n(7144);async function b(e,t,n={},r={}){const a="naavre-communicator/external-service",l={method:"POST",body:JSON.stringify({query:{method:e,url:t,headers:n,data:r}})};console.debug("request",a,l);const i=await async function(e="",t={}){const n=k.ServerConnection.makeSettings(),r=x.URLExt.join(n.baseUrl,e);let a;try{a=await k.ServerConnection.makeRequest(r,t,n)}catch(e){throw new k.ServerConnection.NetworkError(e)}let l=await a.text();if(l.length>0)try{l=JSON.parse(l)}catch(e){console.log("Not a JSON response body.",a)}if(!a.ok)throw new k.ServerConnection.ResponseError(a,l.message||l);return l}(a,l);console.debug("resp",i);try{console.debug("resp.content",JSON.parse(i.content))}catch(e){}return i}var E=n(4943),C=n.n(E);const S={offset:{x:0,y:0},scale:1,nodes:{},links:{},selected:{},hovered:{}};function _(e){return(new(C())).hex(e)}const A=(0,n(710).A)({palette:{secondary:{main:"#ea5b2d",dark:"#b12800",light:"#ff8c5a"},primary:{main:"#0f4e8a",dark:"#00275c",light:"#4e79ba"}}});var L=n(2826),O=n.n(L),R=n(7763);const M=O().div`
  position: absolute;
  background: white;
  width: ${e=>e.width||"250px"};
  height: ${e=>e.height||"150px"};
  border-radius: 5px;
  border: 1px solid lightgray;
`;function G({title:e,backgroundColor:t}){return f().createElement(R.A,{title:e,placement:"bottom",arrow:!0},f().createElement("div",{style:{borderTopLeftRadius:"5px",borderTopRightRadius:"5px",padding:"5px",textAlign:"center",backgroundColor:t}},f().createElement("div",{style:{fontSize:"small",display:"inline-block",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},e)))}const I=f().forwardRef((({node:e,children:t,...n},r)=>function({node:e,children:t,...n},r){const a="workflow-cell"!==e.type;let l="250px",i="150px";return"splitter"===e.type||"merger"===e.type?(l="200px",i="100px"):"visualizer"===e.type&&(l="200px",i="250px"),f().createElement(M,{width:l,height:i,ref:r,...n},f().createElement(G,{title:e.properties.cell.title,backgroundColor:a?"rgb(195, 235, 202)":"rgb(229,252,233)"}),t)}({node:e,children:t,...n},r)));var N=n(709),V=n(4848);const T=(0,N.A)((0,V.jsx)("path",{d:"M17 20.41 18.41 19 15 15.59 13.59 17zM7.5 8H11v5.59L5.59 19 7 20.41l6-6V8h3.5L12 3.5z"}),"CallMerge"),H=(0,N.A)((0,V.jsx)("path",{d:"m14 4 2.29 2.29-2.88 2.88 1.42 1.42 2.88-2.88L20 10V4zm-4 0H4v6l2.29-2.29 4.71 4.7V20h2v-8.41l-5.29-5.3z"}),"CallSplit"),U=(0,N.A)((0,V.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"}),"Image");function j({nodeType:e,sx:t}){switch(e){case"splitter":return g.createElement(H,{sx:{transform:"rotate(90deg)",...t}});case"merger":return g.createElement(T,{sx:{transform:"rotate(90deg)",...t}});case"visualizer":return g.createElement(U,{sx:t});default:return g.createElement(g.Fragment,null)}}function z({node:e}){return g.createElement("div",{style:{width:"190px",padding:"5px",display:"flex",justifyContent:"center"}},g.createElement(j,{nodeType:e.type,sx:{fontSize:"50px"}}))}function D({color:e}){return f().createElement("div",{style:{width:"20px",height:"20px",background:e,borderRadius:"50%",cursor:"pointer"}})}function F(){return f().createElement("div",{style:{marginTop:"20px",width:"20px",height:"20px",background:"#3c8f49",borderRadius:"5px",cursor:"pointer"}})}function W({children:e}){return f().createElement("div",{style:{display:"inline-block",maxWidth:"100px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginLeft:"5px",marginRight:"5px"}},e)}const P=e=>"splitter"===e.port.properties.parentNodeType||"merger"===e.port.properties.parentNodeType?f().createElement(F,null):f().createElement(R.A,{title:e.port.id,placement:"bottom",arrow:!0},f().createElement("div",{style:{display:"flex",justifyContent:"left"===e.port.type?"flex-start":"flex-end"}},"right"===e.port.type&&f().createElement(W,null,e.port.id),f().createElement(D,{color:e.port.properties.color}),"left"===e.port.type&&f().createElement(W,null,e.port.id)));var B=n(2369),Z=n(951),J=n(9579),$=n(4939),q=n(6247),Y=n(3603),K=n(2823),X=n(4327),Q=n(4554),ee=n(2819);function te({title:e,children:t}){return f().createElement(f().Fragment,null,e&&f().createElement(ee.A,{component:"h4",sx:{marginTop:"16px",marginBottom:"16px"}},e),f().createElement(Z.A,{elevation:1},f().createElement(X.A,null,f().createElement(q.A,null,f().createElement(Y.A,null,t)))))}function ne({cells:e}){return f().createElement(Q.A,null,e.map((e=>f().createElement(K.A,null,e))))}function re({name:e}){return f().createElement("div",{style:{width:"20px",height:"20px",background:_(e),borderRadius:"50%"}})}function ae({cell:e}){return f().createElement(J.A,{sx:{margin:"15px"}},f().createElement(te,null,e.container_image&&f().createElement(ne,{cells:["Image name",e.container_image]}),e.base_container_image&&f().createElement(f().Fragment,null,f().createElement(ne,{cells:["Base image (build)",e.base_container_image.build]}),f().createElement(ne,{cells:["Base image (runtime)",e.base_container_image.runtime]})),e.kernel&&f().createElement(ne,{cells:["Kernel",e.kernel]}),e.source_url&&f().createElement(ne,{cells:["Source",f().createElement($.A,{href:e.source_url,target:"_blank",rel:"noreferrer"},e.source_url)]})),e.inputs.length>0&&f().createElement(f().Fragment,null,f().createElement(te,{title:"Inputs"},e.inputs.map((e=>f().createElement(ne,{cells:[f().createElement(re,{name:e.name}),e.name,e.type]}))))),e.outputs.length>0&&f().createElement(f().Fragment,null,f().createElement(te,{title:"Outputs"},e.outputs.map((e=>f().createElement(ne,{cells:[f().createElement(re,{name:e.name}),e.name,e.type]}))))),e.params.length>0&&f().createElement(f().Fragment,null,f().createElement(te,{title:"Parameters"},e.params.map((e=>f().createElement(ne,{cells:[e.name,e.type,e.default_value]}))))),e.secrets.length>0&&f().createElement(f().Fragment,null,f().createElement(te,{title:"Secrets"},e.secrets.map((e=>f().createElement(ne,{cells:[e.name]}))))))}var le=n(2691);const ie=(0,N.A)((0,V.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");function se({children:e,onClose:t}){return g.createElement("div",{className:"naavre-workflow-section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},g.createElement("p",{style:{margin:"0"}},e),g.createElement(le.A,{"aria-label":"Close",style:{color:"white",borderRadius:"100%"},onClick:t},g.createElement(ie,null)))}function oe({link:e,onClose:t}){return g.createElement(se,{onClose:t},"Link")}function ce({node:e,onClose:t}){let n="";switch(e.type){case"splitter":n="Splitter";break;case"merger":n="Merger";break;case"visualizer":n="Visualizer";break;case"workflow-cell":n=e.properties.cell.title}return g.createElement(g.Fragment,null,g.createElement(se,{onClose:t},n),"workflow-cell"===e.type&&g.createElement(ae,{cell:e.properties.cell}))}function de({chart:e,setChart:t,callbacks:n,config:r}){if(!e.selected.id)return g.createElement(g.Fragment,null);function a(){t({...e,selected:{}})}return g.createElement(Z.A,{elevation:6,sx:{position:"absolute",top:20,right:20,width:380,maxHeight:"calc(100% - 40px)",overflowX:"clip",overflowY:"scroll"}},"link"===e.selected.type&&g.createElement(oe,{link:e.links[e.selected.id],onClose:a}),"node"===e.selected.type&&g.createElement(ce,{node:e.nodes[e.selected.id],onClose:a}),g.createElement("div",{style:{margin:"15px"}},g.createElement(B.A,{variant:"contained",onClick:()=>n.onDeleteKey({config:r})},"Delete")))}const pe=(0,N.A)([(0,V.jsx)("path",{d:"M19.03 3.56c-1.67-1.39-3.74-2.3-6.03-2.51v2.01c1.73.19 3.31.88 4.61 1.92zM11 3.06V1.05c-2.29.2-4.36 1.12-6.03 2.51l1.42 1.42C7.69 3.94 9.27 3.25 11 3.06M4.98 6.39 3.56 4.97C2.17 6.64 1.26 8.71 1.05 11h2.01c.19-1.73.88-3.31 1.92-4.61M20.94 11h2.01c-.21-2.29-1.12-4.36-2.51-6.03l-1.42 1.42c1.04 1.3 1.73 2.88 1.92 4.61M7 12l3.44 1.56L12 17l1.56-3.44L17 12l-3.44-1.56L12 7l-1.56 3.44z"},"0"),(0,V.jsx)("path",{d:"M12 21c-3.11 0-5.85-1.59-7.46-4H7v-2H1v6h2v-2.7c1.99 2.84 5.27 4.7 9 4.7 4.87 0 9-3.17 10.44-7.56l-1.96-.45C19.25 18.48 15.92 21 12 21"},"1")],"AutoMode"),he=(0,N.A)((0,V.jsx)("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"CheckCircleOutline");var ue=n(8183),me=n(1178),ge=n(6962);function fe({chart:e,settings:t}){const[n,r]=(0,g.useState)({}),[a,l]=(0,g.useState)({}),[i,s]=(0,g.useState)(null),o=(e,t)=>{r((n=>({...n,[e]:t})))},c=(e,t)=>{l((n=>({...n,[e]:t})))};return(0,g.useEffect)((()=>{Object.values(e.nodes).forEach((e=>{e.properties.cell.params.forEach((e=>{o(e.name,{value:null,default_value:e.default_value})})),e.properties.cell.secrets.forEach((e=>{c(e.name,{value:null})}))}))}),[e.nodes]),f().createElement(y.A,{theme:A},f().createElement("div",{style:{display:"flex",overflow:"scroll",flexDirection:"column"}},i?f().createElement("div",{style:{padding:"10px",alignItems:"center",display:"flex",flexDirection:"column"}},f().createElement(he,{fontSize:"large",sx:{color:me.A[500]}}),f().createElement("p",{style:{fontSize:"large"}},"Workflow submitted! You can track it"," ",f().createElement("a",{target:"_blank",href:i.run_url},"here"))):f().createElement("div",null,0!==Object.keys(n).length&&f().createElement("div",{style:{textAlign:"right",padding:"10px 15px 0 0"}},f().createElement(B.A,{disabled:!1,onClick:async()=>{Object.entries(n).forEach((([e,t])=>{o(e,{value:t.default_value||null,default_value:t.default_value})}))},size:"small",variant:"text",endIcon:f().createElement(pe,{fontSize:"inherit"}),style:{color:ge.A[900],textTransform:"none"}},"Use default parameter values")),f().createElement(X.A,null,f().createElement(q.A,{stickyHeader:!0,"aria-label":"sticky table"},f().createElement(Y.A,null,Object.entries(n).map((([e,t])=>f().createElement(Q.A,{hover:!0,role:"checkbox",tabIndex:-1,key:e},f().createElement(K.A,{key:e,align:"right"},e),f().createElement(K.A,{component:"th",scope:"row"},f().createElement(ue.A,{value:n[e].value,onChange:t=>(async(e,t)=>{o(t,{value:e.target.value,default_value:n[t].default_value})})(t,e)}))))),Object.entries(a).map((([e,t])=>f().createElement(Q.A,{hover:!0,role:"checkbox",tabIndex:-1,key:e},f().createElement(K.A,{key:e,align:"right"},e),f().createElement(K.A,{component:"th",scope:"row"},f().createElement(ue.A,{type:"password",autoComplete:"off",value:a[e].value,onChange:t=>(async(e,t)=>{c(t,{value:e.target.value})})(t,e)})))))))),f().createElement(B.A,{variant:"contained",className:"lw-panel-button",onClick:()=>(async(n,r)=>{b("POST",`${t.workflowServiceUrl}/submit`,{},{virtual_lab:t.virtualLab,naavrewf2:e,params:n,secrets:r}).then((e=>{if(200!==e.status_code)throw`${e.status_code} ${e.reason}`;const t=JSON.parse(e.content);s(t)})).catch((e=>{const t=`Error running the workflow: ${e}`;console.log(t),alert(t)}))})(n,a),color:"primary",disabled:!(()=>{let e=!0;return Object.values(n).forEach((t=>{e=e&&null!==t.value})),Object.values(a).forEach((t=>{e=e&&null!==t.value})),e})(),style:{float:"right",marginTop:"20px"}},"Run"))))}const ye=(0,N.A)((0,V.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh"),we=[{id:"splitter",title:"Splitter",type:"splitter",container_image:"",dependencies:[],inputs:[{name:"splitter_source",type:"list"}],outputs:[{name:"splitter_target",type:"list"}],confs:[],params:[],secrets:[]},{id:"merger",title:"Merger",type:"merger",container_image:"",dependencies:[],inputs:[{name:"merger_source",type:"list"}],outputs:[{name:"merger_target",type:"list"}],confs:[],params:[],secrets:[]},{id:"visualizer",title:"Visualizer",type:"visualizer",container_image:"",dependencies:[],inputs:[{name:"hostname",type:"string"},{name:"username",type:"string"},{name:"password",type:"string"},{name:"remote",type:"string"},{name:"num",type:"string"},{name:"mode",type:"string"},{name:"output",type:"string"}],outputs:[],confs:[],params:[],secrets:[]}];function ve(e){const t=new URL(e);if(t.searchParams.has("page")){const n=Number(t.searchParams.get("page"));if(isNaN(n))throw Error(`Unexpected url: ${e}`);return n}return 1}const xe=(0,N.A)((0,V.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined");function ke({cell:e}){const[t,n]=(0,g.useState)(!1),r=(0,g.useRef)(null);let a;(0,g.useEffect)((()=>{r.current&&n(r.current.scrollWidth>r.current.clientWidth)}),[]);const l=new RegExp(`-${e.owner}$`);return a=e.owner&&e.title.match(l)?f().createElement(f().Fragment,null,e.title.replace(l,""),f().createElement("span",{style:{color:"#6c6c6c"}},"-",e.owner)):e.title,f().createElement(R.A,{title:e.title,disableHoverListener:!t,placement:"bottom",arrow:!0},f().createElement("span",{ref:r,style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},a))}function be({cell:e,selectedCellInList:t,setSelectedCell:n}){const r=(0,g.useRef)(null),a=function(e){const t="type"in e?e.type:"workflow-cell";return{id:e.id,type:t,position:{x:35,y:15},properties:{cell:e},ports:Object.fromEntries([...e.inputs.map((e=>[e.name,{id:e.name,type:"left",properties:{color:_(e.name),parentNodeType:t}}])),...e.outputs.map((e=>[e.name,{id:e.name,type:"right",properties:{color:_(e.name),parentNodeType:t}}]))])}}(e),l="workflow-cell"!==a.type;return f().createElement("div",{ref:r,onClick:function(){t===e?n(null,null):n(e,r.current||null)},draggable:!0,onDragStart:e=>{e.dataTransfer.setData(v.REACT_FLOW_CHART,JSON.stringify({type:a.type,ports:a.ports,properties:a.properties}))},style:{margin:"10px",fontSize:"14px",display:"flex",height:"25px",border:"1px solid lightgray",justifyContent:"space-between",alignItems:"center",background:"rgb(195, 235, 202)",backgroundColor:l?"rgb(195, 235, 202)":"rgb(229,252,233)",borderRadius:"5px",padding:"10px",cursor:"move"}},f().createElement(ke,{cell:e}),f().createElement(le.A,{"aria-label":"Info",style:{borderRadius:"100%"}},f().createElement(xe,null)))}function Ee({title:e,cells:t,minHeightInCells:n,selectedCellInList:r,setSelectedCell:a,button:l,filter:i,pageNav:s}){return f().createElement("div",null,f().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:"40px",paddingRight:"10px",paddingLeft:"10px",background:"#3c8f49",color:"white",fontSize:"medium"}},f().createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis"}},e),l&&l),i&&i,f().createElement("div",{style:{minHeight:n?57*n:void 0}},t.map((e=>f().createElement(be,{cell:e,selectedCellInList:r,setSelectedCell:a})))),s&&s)}var Ce=n(1228);const Se=(0,N.A)((0,V.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),_e=(0,N.A)((0,V.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");function Ae({cellsListResponse:e,setCellsListUrl:t}){const[n,r]=function(e){let t,n;if(null===e.previous&&null===e.next)t=1,n=1;else if(null===e.previous&&null!==e.next)t=1,n=(0,u.ceil)(e.count/e.results.length);else if(null!==e.previous&&null!==e.next){t=ve(e.previous)+1;const r=e.results.length;n=(0,u.ceil)(e.count/r)}else{if(null===e.previous||null!==e.next)throw Error(`Unexpected pagination: ${e}`);t=ve(e.previous)+1,n=t}return[t,n]}(e);return f().createElement(Ce.A,{direction:"row",spacing:1,sx:{justifyContent:"center",alignItems:"center"}},f().createElement(le.A,{"aria-label":"Previous",style:{borderRadius:"100%"},onClick:()=>t(e.previous),sx:{visibility:null===e.previous?"hidden":"visible"}},f().createElement(Se,null)),f().createElement("p",null,"Page ",n," of ",r),f().createElement(le.A,{"aria-label":"Next",style:{borderRadius:"100%"},onClick:()=>t(e.next),sx:{visibility:null===e.next?"hidden":"visible"}},f().createElement(_e,null)))}var Le=n(7984);const Oe=(0,N.A)((0,V.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear"),Re=(0,N.A)((0,V.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),Me=(0,N.A)((0,V.jsx)("path",{d:"M16 17.01V10h-2v7.01h-3L15 21l4-3.99zM9 3 5 6.99h3V14h2V6.99h3z"}),"SwapVert");var Ge=n(988);function Ie({search:e,setSearch:t}){return f().createElement(ue.A,{value:e,onChange:e=>t(e.target.value),slotProps:{input:{startAdornment:f().createElement(Le.InputAdornment,{position:"start"},f().createElement(Re,null)),endAdornment:e&&f().createElement(Le.InputAdornment,{position:"end"},f().createElement(le.A,{"aria-label":"clear search",onClick:()=>t(""),edge:"end",style:{borderRadius:"100%"}},f().createElement(Oe,null)))}},size:"small",sx:{"& .MuiInputBase-root":{borderRadius:"100px"}}})}const Ne=[{value:"modified",label:"First modified"},{value:"-modified",label:"Last modified"},{value:"title",label:"A-Z"},{value:"-title",label:"Z-A"}];function Ve({ordering:e,setOrdering:t}){const[n,r]=f().useState(null),a=Boolean(n);return f().createElement(f().Fragment,null,f().createElement(le.A,{id:"ordering-button","aria-label":"ordering","aria-controls":a?"ordering-menu":void 0,"aria-expanded":a?"true":void 0,"aria-haspopup":"true",style:{borderRadius:"100%"},onClick:e=>r(e.currentTarget)},f().createElement(Me,null)),f().createElement(Le.Menu,{id:"ordering-menu",anchorEl:n,open:a,onClose:()=>r(null),slotProps:{list:{"aria-labelledby":"ordering-button"}}},Ne.map((n=>f().createElement(Le.MenuItem,{key:n.value,selected:n.value===e,onClick:()=>{t(n.value),r(null)}},n.label)))))}function Te({url:e,setUrl:t}){const[n,r]=(0,g.useState)(null),[a,l]=(0,g.useState)("-modified"),[i]=(0,Ge.useDebouncedValue)(n,200);return(0,g.useEffect)((()=>{const n=function(e,t){if(null===e)return null;const n=new URL(e);for(const[e,r]of Object.entries(t))null===r||""===r?n.searchParams.delete(e):n.searchParams.set(e,r);return n.toString()}(e,{search:i,ordering:a,page:null});t(n)}),[i,a]),f().createElement(Ce.A,{direction:"row",spacing:1,sx:{justifyContent:"center",alignItems:"center",padding:"10px"}},f().createElement(Ie,{search:n,setSearch:r}),f().createElement(Ve,{ordering:a,setOrdering:l}))}function He({catalogueServiceUrl:e,selectedCellInList:t,setSelectedCell:n}){const[r,a]=(0,g.useState)(e?`${e}/workflow-cells/?ordering=-modified`:null);(0,g.useEffect)((()=>{a(`${e}/workflow-cells/?ordering=-modified`)}),[e]);const[l,i]=(0,g.useState)({count:0,next:null,previous:null,results:[]}),s=(0,g.useCallback)((e=>{e&&async function(e){const t=await b("GET",e,{accept:"application/json"});if(200!==t.status_code)throw`${t.status_code} ${t.reason}`;return JSON.parse(t.content)}(e).then((e=>i(e)))}),[]);return(0,g.useEffect)((()=>s(r)),[s,r]),f().createElement(Z.A,{elevation:12,style:{position:"absolute",top:0,left:0,width:250,height:"100%",overflowX:"hidden",overflowY:"scroll",display:"flex",flexDirection:"column",borderRadius:0}},f().createElement(Ee,{title:"Cells Catalog",cells:l.results,minHeightInCells:10,selectedCellInList:t,setSelectedCell:n,button:f().createElement(R.A,{title:"Refresh",arrow:!0},f().createElement(le.A,{"aria-label":"Reload",style:{color:"white",borderRadius:"100%"},onClick:()=>s(r)},f().createElement(ye,null))),filter:f().createElement(Te,{url:r,setUrl:a}),pageNav:f().createElement(Ae,{cellsListResponse:l,setCellsListUrl:a})}),f().createElement(Ee,{title:"Special cells",cells:we,selectedCellInList:t,setSelectedCell:n}))}function Ue({cell:e,cellNode:t,onClose:n}){const[r,a]=(0,g.useState)(null);return(0,Ge.useClickOutside)(n,null,[r,t]),f().createElement(Z.A,{ref:a,elevation:12,sx:{position:"absolute",top:20,left:"calc(20px + 250px)",width:380,maxHeight:"calc(100% - 40px)",overflowX:"clip",overflowY:"scroll"}},f().createElement("div",{className:"naavre-workflow-section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},f().createElement("p",{style:{margin:"0"}},e.title),f().createElement(le.A,{"aria-label":"Close",style:{color:"white",borderRadius:"100%"},onClick:n},f().createElement(ie,null))),f().createElement(ae,{cell:e}))}const je={chart:S,selectedCellInList:null,selectedCellNode:null};class ze extends g.Component{constructor(e){super(e),this.state=je,this.chartStateActions=(0,u.mapValues)(w,(e=>(...t)=>{const n=e(...t)(this.state.chart);this.setState({chart:{...this.state.chart,...n}})})),this.chartConfig={readonly:!1},this.setSelectedCell=(e,t)=>{this.setState({selectedCellInList:e,selectedCellNode:t})},this.setChart=e=>{this.setState({chart:e})},this.getRunWorkflowDialogOptions=()=>({title:"Run Workflow",body:l.ReactWidget.create(g.createElement(fe,{chart:this.state.chart,settings:this.props.settings})),buttons:[],hasClose:!0}),this.exportWorkflow=async e=>{b("POST",`${this.props.settings.workflowServiceUrl}/convert`,{},{virtual_lab:this.props.settings.virtualLab,naavrewf2:this.state.chart}).then((t=>{var n;null===(n=e.tracker.currentWidget)||void 0===n||n.model.upload(new File([t.content],"workflow.yaml"))})).catch((e=>{const t=`Error exporting the workflow: ${String(e)}`;console.log(t),alert(t)}))}}componentDidUpdate(){}render(){return g.createElement(y.A,{theme:A},g.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,maxWidth:"100vw",maxHeight:"100vh"}},g.createElement("div",{style:{display:"flex",flexDirection:"column",flex:"1",overflow:"hidden"}},g.createElement(v.FlowChart,{chart:this.state.chart,callbacks:this.chartStateActions,config:this.chartConfig,Components:{Node:I,NodeInner:z,Port:P}}),this.state.chart.selected.id&&g.createElement(de,{chart:this.state.chart,setChart:this.setChart,callbacks:this.chartStateActions,config:this.chartConfig}),this.state.selectedCellInList&&g.createElement(Ue,{cell:this.state.selectedCellInList,cellNode:this.state.selectedCellNode,onClose:()=>this.setSelectedCell(null,null)}),g.createElement(He,{catalogueServiceUrl:this.props.settings.catalogueServiceUrl,selectedCellInList:this.state.selectedCellInList,setSelectedCell:this.setSelectedCell}))))}}class De extends p.DocumentWidget{constructor(e){super(e)}updateSettings(e){this.content.updateSettings(e)}dispose(){this.content.dispose(),super.dispose()}}class Fe extends l.ReactWidget{constructor(e){super(),this.settings={},this._onContentChanged=()=>{var e;null===(e=this.composerRef.current)||void 0===e||e.setState({chart:this._model.chart})},this.addClass("vre-composer"),this.composerRef=f().createRef(),this._model=e.model,e.ready.then((e=>{this._model.contentChanged.connect(this._onContentChanged),this._onContentChanged(),this.update()})),this._onContentChanged()}updateSettings(e){this.settings={...this.settings,...e},this.update()}render(){return f().createElement(ze,{ref:this.composerRef,settings:this.settings})}dispose(){this.isDisposed||(this._model.contentChanged.disconnect(this._onContentChanged),h.Signal.clearData(this),super.dispose())}onAfterAttach(e){super.onAfterAttach(e),this.node.addEventListener("focusout",this,!0)}onBeforeDetach(e){this.node.removeEventListener("focusout",this,!0),super.onBeforeDetach(e)}handleEvent(e){var t,n;e.preventDefault(),e.stopPropagation(),e.type&&"focusout"===e.type&&(m().isEqual(this._model.chart,null===(t=this.composerRef.current)||void 0===t?void 0:t.state.chart)||(this._model.chart=(null===(n=this.composerRef.current)||void 0===n?void 0:n.state.chart)||S))}}var We=n(8e3);class Pe{constructor(e){this.defaultKernelName="",this.defaultKernelLanguage="",this.sharedModel=Be.create(),this._onClientChanged=()=>{const e=this.sharedModel.awareness.getStates();this._clientChanged.emit(e)},this._onSharedModelChanged=(e,t)=>{t.chartChange&&this.triggerContentChange(),t.stateChange&&t.stateChange.forEach((e=>{"dirty"===e.name?this.dirty=e.newValue:e.oldValue!==e.newValue&&this.triggerStateChange({newValue:void 0,oldValue:void 0,...e})}))},this._dirty=!1,this._isDisposed=!1,this._readOnly=!1,this._clientChanged=new h.Signal(this),this._contentChanged=new h.Signal(this),this._stateChanged=new h.Signal(this);const{collaborationEnabled:t,sharedModel:n}=e;this._collaborationEnabled=!!t,this.sharedModel=n||Be.create(),this.sharedModel.changed.connect(this._onSharedModelChanged),this.sharedModel.awareness.on("change",this._onClientChanged)}get collaborative(){return this._collaborationEnabled}get dirty(){return this._dirty}set dirty(e){const t=this._dirty;e!==t&&(this._dirty=e,this.triggerStateChange({name:"dirty",oldValue:t,newValue:e}))}get isDisposed(){return this._isDisposed}get readOnly(){return this._readOnly}set readOnly(e){if(e===this._readOnly)return;const t=this._readOnly;this._readOnly=e,this.triggerStateChange({name:"readOnly",oldValue:t,newValue:e})}get clientId(){return this.sharedModel.awareness.clientID}get chart(){return this.sharedModel.get("chart")}set chart(e){this.sharedModel.set("chart",e)}get clientChanged(){return this._clientChanged}get contentChanged(){return this._contentChanged}get stateChanged(){return this._stateChanged}dispose(){this._isDisposed||(this._isDisposed=!0,h.Signal.clearData(this))}toString(){return this.sharedModel.getSource()}fromString(e){this.sharedModel.setSource(e)}toJSON(){return JSON.parse(this.toString()||"null")}fromJSON(e){this.fromString(JSON.stringify(e))}initialize(){}triggerStateChange(e){this._stateChanged.emit(e)}triggerContentChange(){this._contentChanged.emit(void 0),this.dirty=!0}}class Be extends We.YDocument{constructor(){super(),this.version="1.0.0",this._contentObserver=e=>{const t={};e.keysChanged.has("chart")&&(t.chartChange=this._content.get("chart")),this._changed.emit(t)},this._content=this.ydoc.getMap("content"),this._content.observe(this._contentObserver)}getSource(){var e;const t={chart:null!==(e=this.get("chart"))&&void 0!==e?e:S};return JSON.stringify(t,null,2)}setSource(e){let t=S;if(e){const n=JSON.parse(e);t=n.chart}this.transact((()=>{this.set("chart",t)}))}dispose(){this.isDisposed||(this._content.unobserve(this._contentObserver),super.dispose())}static create(){return new Be}get(e){const t=this._content.get(e);return"chart"===e?t?JSON.parse(t):S:null!=t?t:""}set(e,t){this._content.set(e,["chart"].includes(e)?JSON.stringify(t):t)}}class Ze extends p.ABCWidgetFactory{constructor(e){super(e)}createNewWidget(e){return new De({context:e,content:new Fe(e)})}}class Je{constructor(){this.collaborative=!0,this._disposed=!1}get name(){return"naavrewf-model"}get contentType(){return"naavrewfdoc"}get fileFormat(){return"text"}get isDisposed(){return this._disposed}dispose(){this._disposed=!0}preferredLanguage(e){return""}createNew(e){return new Pe(e)}}var $e,qe=n(5926);!function(e){e.createSaveButton=function(e,t){return new l.ToolbarButton({label:"Save",tooltip:"Save the workflow",icon:qe.saveIcon,onClick:()=>{t.execute("docmanager:save")}})},e.createExportButton=function(e,t){return new l.ToolbarButton({label:"Export",tooltip:"Export the workflow",icon:qe.codeIcon,onClick:()=>{var n;null===(n=e.content.composerRef.current)||void 0===n||n.exportWorkflow(t)}})},e.createRunButton=function(e){return new l.ToolbarButton({label:"Run",tooltip:"Run the workflow",icon:qe.runIcon,onClick:()=>{var t;return(0,l.showDialog)(null===(t=e.content.composerRef.current)||void 0===t?void 0:t.getRunWorkflowDialogOptions())}})}}($e||($e={}));const Ye=new qe.LabIcon({name:"launcher-icon",svgstr:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   width="66.69"\n   height="66.69"\n   viewBox="0 0 66.69 66.69"\n   version="1.1"\n   id="svg5"\n   sodipodi:docname="launcher-icon.svg"\n   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n  <sodipodi:namedview\n     id="namedview5"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:showpageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     inkscape:deskcolor="#d1d1d1"\n     inkscape:zoom="5.6423717"\n     inkscape:cx="12.671976"\n     inkscape:cy="62.739574"\n     inkscape:current-layer="svg5" />\n  <defs\n     id="defs1">\n    <linearGradient\n       id="swatch5"\n       inkscape:swatch="solid">\n      <stop\n         style="stop-color:#3c8f49;stop-opacity:1;"\n         offset="0"\n         id="stop5" />\n    </linearGradient>\n    <style\n       id="style1">\n      .a92fba6e-7ebd-4c32-8963-8296e20ef654 {\n        fill: #0f4e8b;\n      }\n    </style>\n    <linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch5"\n       id="linearGradient5"\n       x1="0"\n       y1="33.352931"\n       x2="66.69"\n       y2="33.352931"\n       gradientUnits="userSpaceOnUse" />\n  </defs>\n  <g\n     id="a472ef7c-dd17-4d49-9df0-027f7f177a8f"\n     data-name="Livello 2"\n     style="fill:url(#linearGradient5)">\n    <g\n       id="b55479a9-ce75-42ce-9f6a-fdbd00d931c6"\n       data-name="Livello 1"\n       style="fill:url(#linearGradient5)">\n      <g\n         id="g5"\n         style="fill:url(#linearGradient5)">\n        <path\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           d="M33.34,40.87a5.38,5.38,0,1,0,5.38,5.38,5.39,5.39,0,0,0-5.38-5.38Zm0,8.61a3.23,3.23,0,1,1,3.23-3.23,3.23,3.23,0,0,1-3.23,3.23Z"\n           id="path1"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="32.27"\n           y="4.3"\n           width="8.6"\n           height="2.15"\n           id="rect1"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="32.27"\n           y="8.6"\n           width="8.6"\n           height="2.15"\n           id="rect2"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="12.91"\n           width="15.06"\n           height="2.15"\n           id="rect3"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="17.21"\n           width="15.06"\n           height="2.15"\n           id="rect4"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="21.51"\n           width="15.06"\n           height="2.15"\n           id="rect5"\n           style="fill:url(#linearGradient5)" />\n        <path\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           d="M66.69,34.42V25.81H51.63v8.61h6.45V45.17H45.17V43.32l-2.64-.88L43.78,40l-4.14-4.14-2.49,1.25-.88-2.64H34.42V28H45.17V15.06H58.08v6L55.62,18.6l-1.53,1.52,5.07,5.06,5.06-5.06L62.7,18.6l-2.47,2.47V12.91H45.17V0H28.6L21.51,7.08v5.83H6.45v8.16L4,18.6,2.47,20.12l5.06,5.06,5.06-5.06L11.07,18.6,8.6,21.07v-6H21.51V28H32.27v6.45H30.42l-.88,2.64-2.49-1.25L22.91,40l1.24,2.49-2.64.88v1.85H8.6V34.42h6.46V25.81H0v8.61H6.45V51.78a4.31,4.31,0,1,0,2.15,0V47.33h6.46v13.1a3.23,3.23,0,1,0,2.15,0V47.33h4.3v1.85l2.64.88-1.24,2.49,4.14,4.14,2.49-1.25.88,2.64h5.85l.88-2.64,2.49,1.25,4.14-4.14-1.25-2.49,2.64-.88V47.33h4.31v13.1a3.23,3.23,0,1,0,2.15,0V47.33h6.45v4.45a4.31,4.31,0,1,0,2.15,0V34.42ZM28,3.67V6.45H25.18ZM23.66,8.6h6.46V2.15H43V25.81H23.66ZM2.15,28H12.91v4.3H2.15Zm7.53,28a2.15,2.15,0,1,1-2.15-2.15,2.15,2.15,0,0,1,2.15,2.15Zm6.45,8.61a1.08,1.08,0,1,1,1.08-1.08,1.08,1.08,0,0,1-1.08,1.08ZM43,47.63l-2.46.82-.19.47c0,.14-.1.28-.16.41L40,49.8l1.16,2.32-1.94,2-2.33-1.16-.46.2-.41.17-.48.18-.82,2.47H32l-.83-2.47-.48-.18-.4-.17-.46-.2-2.33,1.16-1.95-2,1.17-2.32-.21-.47c-.06-.13-.11-.27-.17-.41l-.18-.47-2.47-.82V44.87l2.47-.82.18-.47c.06-.14.11-.28.17-.41l.21-.47-1.17-2.32,1.95-2,2.33,1.16.46-.2.4-.17.48-.18L32,36.57h2.75L35.54,39l.48.18.41.17.46.21,2.33-1.17,1.94,2L40,42.7l.21.47c.06.13.11.27.17.41l.18.47,2.46.83Zm7.53,16.91a1.08,1.08,0,1,1,1.08-1.08,1.08,1.08,0,0,1-1.08,1.08Zm10.76-8.61a2.15,2.15,0,1,1-2.15-2.15,2.15,2.15,0,0,1,2.15,2.15ZM53.78,28H64.54v4.3H53.78Z"\n           id="path5"\n           style="fill:url(#linearGradient5)" />\n      </g>\n    </g>\n  </g>\n</svg>\n'});var Ke,Xe;new qe.LabIcon({name:"panel-icon",svgstr:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n\x3c!-- Created with Inkscape (http://www.inkscape.org/) --\x3e\n\n<svg\n   width="20"\n   height="20"\n   version="1.1"\n   viewBox="0 0 5.2916639 5.2916639"\n   xml:space="preserve"\n   id="svg7"\n   sodipodi:docname="extension-icon.svg"\n   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg"><defs\n     id="defs7"><linearGradient\n       id="swatch20"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop20" /></linearGradient><linearGradient\n       id="swatch12"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop12" /></linearGradient><linearGradient\n       id="swatch9"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop9" /></linearGradient><linearGradient\n       id="swatch8"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#3c8f49;stop-opacity:1;"\n         offset="0"\n         id="stop8" /></linearGradient><linearGradient\n       id="swatch7"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop7" /></linearGradient><clipPath\n       clipPathUnits="userSpaceOnUse"\n       id="clipPath33"><path\n         d="M 0,0 H 595.276 V 841.89 H 0 Z"\n         transform="translate(-364.14791,-348.99961)"\n         id="path33" /></clipPath><clipPath\n       clipPathUnits="userSpaceOnUse"\n       id="clipPath40"><path\n         d="M 0,0 H 595.276 V 841.89 H 0 Z"\n         transform="translate(-395.09281,-354.98901)"\n         id="path40" /></clipPath><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient7"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient9"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient10"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.95489,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient11"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient12"\n       x1="38.725582"\n       y1="239.17892"\n       x2="119.33492"\n       y2="239.17892"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400997,24.954895,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient13"\n       x1="75.722961"\n       y1="217.14847"\n       x2="82.33754"\n       y2="217.14847"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437954,0,0,20.400997,24.954894,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient20"\n       x1="31.019951"\n       y1="250.64404"\n       x2="53.045799"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437954,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient21"\n       x1="105.01471"\n       y1="250.64404"\n       x2="127.04055"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400998,24.954894,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient22"\n       x1="68.017326"\n       y1="250.64404"\n       x2="90.043175"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400998,24.954894,177.72344)" /></defs><sodipodi:namedview\n     id="namedview7"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:showpageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     inkscape:deskcolor="#d1d1d1"\n     inkscape:zoom="27.188668"\n     inkscape:cx="7.3192259"\n     inkscape:cy="21.001397"\n     inkscape:current-layer="g22"\n     showgrid="false"><inkscape:grid\n       id="grid1"\n       units="px"\n       originx="-0.5291664"\n       originy="-0.5291664"\n       spacingx="0.2645832"\n       spacingy="0.2645832"\n       empcolor="#ff3f3f"\n       empopacity="0.25098039"\n       color="#3f3fff"\n       opacity="0.1254902"\n       empspacing="10"\n       enabled="true"\n       visible="false" /></sodipodi:namedview><g\n     id="g22"\n     transform="matrix(0.04892858,0,0,0.04901721,-1.2210061,-8.7115099)"\n     style="stroke-width:5.40265;stroke-dasharray:none"><path\n       id="rect7"\n       style="opacity:1;fill:none;stroke:url(#linearGradient7);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 27.65618,261.39123 h 21.635064 v 21.58618 H 27.65618 Z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect9"\n       style="opacity:1;fill:none;stroke:url(#linearGradient9);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 65.508951,261.39123 h 21.635064 v 21.58618 H 65.508951 Z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect10"\n       style="opacity:1;fill:none;stroke:url(#linearGradient10);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 103.36172,261.39123 h 21.63507 v 21.58618 h -21.63507 z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect11"\n       style="opacity:1;fill:none;stroke:url(#linearGradient11);stroke-width:5.40262;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="M 65.508946,180.42481 V 202.011 H 87.14402 v -21.58619 z" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient13);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 76.324548,210.11006 v 37.78433"\n       id="path11"\n       sodipodi:nodetypes="cc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient12);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="M 38.471258,247.89439 V 223.6069 h 75.710452 v 24.28749"\n       id="path12"\n       sodipodi:nodetypes="cccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient20);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 26.855112,237.89486 11.716755,11.59659 11.716756,-11.59659"\n       id="path18"\n       inkscape:transform-center-y="-0.28421607"\n       sodipodi:nodetypes="ccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient21);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 102.56065,237.89487 11.71676,11.59659 11.71676,-11.59659"\n       id="path19"\n       inkscape:transform-center-y="-0.28421561"\n       sodipodi:nodetypes="ccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient22);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 64.707883,237.89487 11.716756,11.59659 11.716756,-11.59659"\n       id="path20"\n       inkscape:transform-center-y="-0.28421561"\n       sodipodi:nodetypes="ccc" /></g></svg>\n'}),function(e){e.createNew="create-vre-composer"}(Ke||(Ke={})),function(e){e.addCommands=function(e,t,n){e.addCommand(Ke.createNew,{label:"Experiment Manager",caption:"Launch Workflow Composition",icon:e=>e.isPalette?void 0:Ye,execute:r=>{var a;return async function(e,t,n){const r=await e.execute("docmanager:new-untitled",{path:t,type:"file",ext:"naavrewf"});if(void 0!==r){const t=await e.execute("docmanager:open",{path:r.path,factory:n});return t.isUntitled=!0,t}}(e,r.cwd||(null===(a=t.tracker.currentWidget)||void 0===a?void 0:a.model.path),n)}})}}(Xe||(Xe={}));const Qe="NaaVRE workflow editor",et=new s.Token("naavrewfDocTracker"),tt={id:"@naavre/workflow-jupyterlab:plugin",autoStart:!0,requires:[a.ILayoutRestorer,i.ILauncher,c.ITranslator,l.IToolbarWidgetRegistry,o.ISettingRegistry,d.IFileBrowserFactory],optional:[r.ICollaborativeDrive],provides:et,activate:(e,t,n,r,a,i,s,o)=>{let c;console.log("JupyterLab extension @naavre/workflow-jupyterlab is activated!"),Xe.addCommands(e.commands,s,Qe),n&&n.add({command:Ke.createNew,category:"VRE Components",rank:0}),a&&(a.registerFactory(Qe,"saveWorkflow",(t=>$e.createSaveButton(t,e.commands))),a.registerFactory(Qe,"exportWorkflow",(e=>$e.createExportButton(e,s))),a.registerFactory(Qe,"runWorkflow",(e=>$e.createRunButton(e))),i&&(c=(0,l.createToolbarFactory)(a,i,Qe,tt.id,r)));const d=new l.WidgetTracker({namespace:"documents-naavrewf"});function p(e){var t;null===(t=d.currentWidget)||void 0===t||t.updateSettings(e.composite)}if(t&&t.restore(d,{command:"docmanager:open",args:e=>({path:e.context.path,factory:Qe}),name:e=>e.context.path}),i&&Promise.all([e.restored,i.load(tt.id)]).then((([,e])=>{p(e),e.changed.connect(p),d.currentChanged.connect((()=>p(e)))})).catch((e=>{console.error("Failed to load settings for @naavre/containerizer-jupyterlab.",e)})),e.docRegistry.addFileType({name:"naavrewf",displayName:"NaaVRE Workflow",mimeTypes:["text/json","application/json"],extensions:[".naavrewf"],fileFormat:"text",contentType:"naavrewfdoc"}),o){const e=()=>Be.create();o.sharedModelFactory.registerDocumentFactory("naavrewfdoc",e)}const h=new Je;e.docRegistry.addModelFactory(h);const u=new Ze({name:Qe,modelName:"naavrewf-model",fileTypes:["naavrewf"],defaultFor:["naavrewf"],toolbarFactory:c});u.widgetCreated.connect(((e,t)=>{t.context.pathChanged.connect((()=>{d.save(t)})),d.add(t)})),e.docRegistry.addWidgetFactory(u)}},nt=tt}}]);