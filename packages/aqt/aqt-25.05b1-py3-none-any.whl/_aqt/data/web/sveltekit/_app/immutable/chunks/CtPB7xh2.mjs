import"./Bg9kRutz.mjs";import{i as le}from"./nnh_QitT.mjs";import{p as ne,h as f,b as D,r as v,c as k,d as oe,i as E,l as U,a as pe,V as _,g as c,m as j,s as G,T as J,e as Re,f as me,aP as Ne}from"./DV-2yDg-.mjs";import{p as ee,i as te}from"./x5bsbXB-.mjs";import{X as qe,Y as Me,Z as Ie,_ as Pe,$ as Ke,a0 as Ye,a1 as Le,a2 as $e,a3 as Be,a4 as Fe,a5 as ke,a6 as We,a7 as Ge,a8 as Oe,a9 as ze,aa as Ue,ab as je,ac as He,ad as Ve,ae as Je,af as Xe,ag as Ze,ah as Qe,ai as et,aj as tt,ak as at,q as we,al as xe,am as rt,an as it,ao as st,ap as lt,aq as nt,ar as ot,as as vt,at as ct,au as dt,u as ut,av as de,aw as ft,ax as mt,ay as pt,az as gt,T as ht}from"./BWUD79Mq.mjs";import{C as bt}from"./BlHEOJO4.mjs";import{e as Z,i as Q,R as he}from"./QLt-JbE0.mjs";import{s as L}from"./C_re1EiV.mjs";import{t as O,D as yt,T as Te}from"./BnOv7LJi.mjs";import{b as _t}from"./DpsVa0Mt.mjs";import{R as Y}from"./Ep9fPH5z.mjs";import{y as St,z as be,A as wt,B as xt,C as Dt,D as Rt,E as Lt,F as De,G as $t,H as Ft,I as kt,J as Tt,K as Ct,N as Et,L as At,M as Nt}from"./7wO9rilM.mjs";import{m as qt}from"./D1slsF82.mjs";import{t as Mt}from"./CCCHPHPl.mjs";import{b as ue}from"./Bj9ye7vG.mjs";import{b as It}from"./Dz-DtsIW.mjs";import{s as Pt,b as se,a as Kt}from"./DDtyVqW1.mjs";import{w as Yt}from"./DqGH9kBy.mjs";var Bt=E('<div class="card-info-placeholder svelte-16vamgt"> </div>');function Wt(l,m){ne(m,!1),le();var n=Bt(),e=f(n,!0);D(()=>L(e,qe())),v(n),k(l,n),oe()}var Gt=E('<tr><th class="align-start svelte-1ws7hzc"> </th><td> </td></tr>'),Ot=E('<table class="stats-table align-start svelte-1ws7hzc"><tbody></tbody></table>');function zt(l,m){ne(m,!1);let n=ee(m,"stats",8);function e(t){return new Te(Number(t)).dateString()}function h(t){const r=[];if(r.push({label:Me(),value:e(t.added)}),t.firstReview!=null&&r.push({label:Ie(),value:e(t.firstReview)}),t.latestReview!=null&&r.push({label:Pe(),value:e(t.latestReview)}),t.dueDate!=null&&r.push({label:Ke(),value:e(t.dueDate)}),t.duePosition!=null&&r.push({label:Ye(),value:t.duePosition}),t.interval&&r.push({label:Le(),value:O(t.interval*yt)}),t.memoryState){let g=O(t.memoryState.stability*86400,!1,!1);if(t.memoryState.stability>31){const a=t.memoryState.stability.toFixed(0);g+=` (${a})`}r.push({label:$e(),value:g});const x=((t.memoryState.difficulty-1)/9*100).toFixed(0);if(r.push({label:Be(),value:`${x}%`}),t.fsrsRetrievability){const a=(t.fsrsRetrievability*100).toFixed(0);r.push({label:Fe(),value:`${a}%`})}}else t.ease&&r.push({label:ke(),value:`${t.ease/10}%`});r.push({label:We(),value:t.reviews}),r.push({label:Ge(),value:t.lapses}),t.totalSecs&&(r.push({label:Oe(),value:O(t.averageSecs)}),r.push({label:ze(),value:O(t.totalSecs)})),r.push({label:Ue(),value:t.cardType}),r.push({label:je(),value:t.notetype});let p;if(t.originalDeck?p=`${t.deck} (${t.originalDeck})`:p=t.deck,r.push({label:He(),value:p}),r.push({label:Ve(),value:t.preset}),r.push({label:Je(),value:t.cardId}),r.push({label:Xe(),value:t.noteId}),t.customData){let g;try{const x=JSON.parse(t.customData);g=Object.entries(x).map(([a,d])=>`${a}=${d}`).join(" ")}catch{g=t.customData}r.push({label:Ze(),value:g})}return r}let s=j();U(()=>J(n()),()=>{G(s,h(n()))}),pe(),le();var o=Ot(),T=f(o);Z(T,5,()=>c(s),Q,(t,r)=>{var p=Gt(),g=f(p),x=f(g,!0);v(g);var a=_(g),d=f(a,!0);v(a),v(p),D(()=>{L(x,c(r).label),L(d,c(r).value)}),k(t,p)}),v(T),v(o),k(l,o),oe()}const Ut=1e3;function fe(l,m,n){const e=Math.pow(.9,1/-n)-1;return Math.pow(m/l*e+1,-n)}var w=(l=>(l[l.Week=0]="Week",l[l.Month=1]="Month",l[l.Year=2]="Year",l[l.AllTime=3]="AllTime",l))(w||{});const jt={0:7,1:30,2:365,3:1/0};function Ht(l,m){return l.filter(n=>n.daysSinceFirstLearn<=m)}function ye(l){return l.reviewKind!==Y.MANUAL&&l.reviewKind!==Y.RESCHEDULED&&(l.reviewKind!==Y.FILTERED||l.ease!==0)}function Vt(l){const m=[];for(const n of l){if(n.reviewKind===Y.MANUAL&&n.ease===0||n.memoryState===void 0)break;m.push(n)}return m.filter(n=>ye(n))}function Jt(l,m,n){const e=[];let h=0,s=0;const o=Math.min(m/Ut,1);let T=0;if(l.slice().reverse().forEach((u,b)=>{var M,A;const C=Number(u.time);if(b===0){h=C,s=((M=u.memoryState)==null?void 0:M.stability)||0,e.push({date:new Date(C*1e3),daysSinceFirstLearn:0,elapsedDaysSinceLastReview:0,retrievability:100,stability:s});return}const I=(C-h)/86400;let $=0;for(;$<I-o;){$+=o;const i=fe(s,$,n);e.push({date:new Date((h+$*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+o,elapsedDaysSinceLastReview:$,retrievability:i*100,stability:s})}T+=I,e.push({date:new Date((h+I*86400)*1e3),daysSinceFirstLearn:T,retrievability:100,elapsedDaysSinceLastReview:0,stability:s}),h=C,s=((A=u.memoryState)==null?void 0:A.stability)||0}),e.length===0)return[];const t=Date.now()/1e3,r=(t-h)/86400;let p=0;for(;p<r-o;){p+=o;const u=fe(s,p,n);e.push({date:new Date((h+p*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+o,elapsedDaysSinceLastReview:p,retrievability:u*100,stability:s})}T+=r;const g=fe(s,r,n);e.push({date:new Date(t*1e3),daysSinceFirstLearn:T,elapsedDaysSinceLastReview:r,retrievability:g*100,stability:s});const x=m-r;let a=0;for(;a<x;){a+=o;const u=fe(s,p+a,n);e.push({date:new Date((t+a*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+o,elapsedDaysSinceLastReview:r+a,retrievability:u*100,stability:s})}return Ht(e,m)}function Ce(l,m){if(l.length===0)return 0;const n=new Date,e=(n.getTime()/1e3-Number(l[l.length-1].time))/86400,h=(n.getTime()/1e3-Number(l[0].time))/86400,s=l[0].interval/86400,o=Math.max(s*1.5-h,s*.5);return Math.min(e+o,jt[m])}function Xt(l,m,n,e,h,s){const o=St(n),T=o.transition().duration(600);if(l.length===0){be(o,!1);return}const t=Ce(l,m),r=Jt(l,t,s);if(r.length===0){be(o,!1);return}else be(o,!0);o.selectAll(".forgetting-curve-line").remove(),o.select(".hover-columns").remove();const p=qt(r,i=>i.date),g=wt(r,i=>i.date),x=Mt().domain([p,g]).range([e.marginLeft,e.width-e.marginRight]),a=Math.max(0,100-1.2*(100-Math.min(...r.map(i=>i.retrievability)))),d=xt().domain([a,100]).range([e.height-e.marginBottom,e.marginTop]);o.select(".x-ticks").call(i=>i.transition(T).call(Dt(x).ticks(5).tickSizeOuter(0))).attr("direction","ltr"),o.select(".y-ticks").attr("transform",`translate(${e.marginLeft},0)`).call(i=>i.transition(T).call(Rt(d).tickSizeOuter(0))).attr("direction","ltr"),o.select(".y-ticks .y-axis-title").remove(),o.select(".y-ticks").append("text").attr("class","y-axis-title").attr("transform","rotate(-90)").attr("y",0-e.marginLeft).attr("x",0-e.height/2).attr("font-size","1rem").attr("dy","1.1em").attr("fill","currentColor");const u=Lt().x(i=>x(i.date)).y(i=>d(i.retrievability)),b=h*100;o.append("linearGradient").attr("id","line-gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",d(0)).attr("x2",0).attr("y2",d(100)).selectAll("stop").data([{offset:"0%",color:"tomato"},{offset:`${b}%`,color:"steelblue"},{offset:"100%",color:"green"}]).enter().append("stop").attr("offset",i=>i.offset).attr("stop-color",i=>i.color);const C=new Date,I=r.filter(i=>i.date<=C),$=r.filter(i=>i.date>=C);o.append("path").datum(I).attr("class","forgetting-curve-line").attr("fill","none").attr("stroke","url(#line-gradient)").attr("stroke-width",1.5).attr("d",u),o.append("path").datum($).attr("class","forgetting-curve-line").attr("fill","none").attr("stroke","url(#line-gradient)").attr("stroke-width",1.5).attr("stroke-dasharray","4 4").attr("d",u),o.select(".desired-retention-line").remove(),b>a&&o.append("line").attr("class","desired-retention-line").attr("x1",e.marginLeft).attr("x2",e.width-e.marginRight).attr("y1",d(b)).attr("y2",d(b)).attr("stroke","steelblue").attr("stroke-dasharray","4 4").attr("stroke-width",1.2);const M=o.append("line").attr("class","focus-line").attr("y1",e.marginTop).attr("y2",e.height-e.marginBottom).attr("stroke","black").attr("stroke-width",1).style("opacity",0);function A(i){return`${t>=365?"Date":"Date Time"}: ${t>=365?i.date.toLocaleDateString():i.date.toLocaleString()}<br>
        ${et()}: ${O(i.elapsedDaysSinceLastReview*86400)}<br>${Fe()}: ${i.retrievability.toFixed(2)}%<br>${$e()}: ${O(i.stability*86400)}`}o.append("g").attr("class","hover-columns").selectAll("rect").data(r).join("rect").attr("x",i=>x(i.date)-1).attr("y",e.marginTop).attr("width",2).attr("height",e.height-e.marginTop-e.marginBottom).attr("fill","transparent").on("mousemove",(i,F)=>{const[N,H]=De(i,document.body),[re,z]=De(i,o.node()),B=d(b);M.attr("x1",x(F.date)-1).attr("x2",x(F.date)+1).style("opacity",1);let X=A(F);z>=B-10&&z<=B+10&&(X+=`<br>${Qe()}: ${h.toFixed(2)}`),$t(X,N,H)}).on("mouseout",()=>{M.style("opacity",0),Ft()})}var Zt=E('<div class="svelte-1bf093q"><b> </b> <span class="hidden-xs svelte-1bf093q"> </span></div>'),Qt=E("<div> </div>"),ea=E("<div> </div>"),ta=E('<div class="svelte-1bf093q"> </div>'),aa=E('<div class="svelte-1bf093q"> </div>'),ra=E('<div class="svelte-1bf093q"> </div>'),ia=E('<div class="revlog-table svelte-1bf093q"><div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column hidden-xs svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content right svelte-1bf093q"></div></div> <div class="column hidden-xs svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content right svelte-1bf093q"></div></div></div>');function sa(l,m){ne(m,!1);const n=j();let e=ee(m,"revlog",8);const h=!1;function s(a){switch(a.reviewKind){case Y.LEARNING:return"revlog-learn";case Y.REVIEW:return"revlog-review";case Y.RELEARNING:return"revlog-relearn"}return""}function o(a){switch(a.reviewKind){case Y.LEARNING:return ct();case Y.REVIEW:return vt();case Y.RELEARNING:return ot();case Y.FILTERED:return nt();case Y.MANUAL:return lt();case Y.RESCHEDULED:return st()}}function T(a){return a.buttonChosen===1?"revlog-ease1":""}function t(a,d){var b;const u=new Te(Number(a.time));return{date:u.dateString(),time:u.timeString(),reviewKind:o(a),reviewKindClass:s(a),rating:a.buttonChosen,ratingClass:T(a),interval:O(a.interval),ease:r(a.ease),takenSecs:O(a.takenSecs,!0),elapsedTime:d,stability:(b=a.memoryState)!=null&&b.stability?O(a.memoryState.stability*86400):""}}function r(a){if(a===0)return"";const d=a/10;return d<=110?`D:${(d-10).toFixed(0)}%`:`${d.toFixed(0)}%`}U(()=>(J(e()),O),()=>{G(n,e().map((a,d)=>{let u,b=d+1;for(;b<e().length;){if(ye(e()[b])){u=e()[b];break}b++}let C="N/A";return ye(a)&&(C=u?O(Number(a.time)-Number(u.time)):"0"),t(a,C)}))}),pe(),le();var p=Re(),g=me(p);{var x=a=>{var d=ia(),u=f(d),b=f(u),C=f(b,!0);D(()=>L(C,tt())),v(b);var I=_(b,2);Z(I,5,()=>c(n),Q,(q,S)=>{var y=Zt(),K=f(y),Ee=f(K,!0);v(K);var _e=_(K,2),Ae=f(_e);v(_e),v(y),D(()=>{var Se;L(Ee,c(S).date),L(Ae,`@ ${(Se=c(S).time)!=null?Se:""}`)}),k(q,y)}),v(I),v(u);var $=_(u,2),M=f($),A=f(M,!0);D(()=>L(A,at())),v(M);var i=_(M,2);Z(i,5,()=>c(n),Q,(q,S)=>{var y=Qt(),K=f(y,!0);v(y),D(()=>{we(y,xe(c(S).reviewKindClass),"svelte-1bf093q"),L(K,c(S).reviewKind)}),k(q,y)}),v(i),v($);var F=_($,2),N=f(F),H=f(N,!0);D(()=>L(H,rt())),v(N);var re=_(N,2);Z(re,5,()=>c(n),Q,(q,S)=>{var y=ea(),K=f(y,!0);v(y),D(()=>{we(y,xe(c(S).ratingClass),"svelte-1bf093q"),L(K,c(S).rating)}),k(q,y)}),v(re),v(F);var z=_(F,2),B=f(z),X=f(B,!0);D(()=>L(X,Le())),v(B);var ve=_(B,2);Z(ve,5,()=>c(n),Q,(q,S)=>{var y=ta(),K=f(y,!0);v(y),D(()=>L(K,c(S).interval)),k(q,y)}),v(ve),v(z);var ae=_(z,2),ie=f(ae),ge=f(ie,!0);D(()=>L(ge,ke())),v(ie);var ce=_(ie,2);Z(ce,5,()=>c(n),Q,(q,S)=>{var y=aa(),K=f(y,!0);v(y),D(()=>L(K,c(S).ease)),k(q,y)}),v(ce),v(ae);var R=_(ae,2),W=f(R),P=f(W,!0);D(()=>L(P,it())),v(W);var V=_(W,2);Z(V,5,()=>c(n),Q,(q,S)=>{var y=ra(),K=f(y,!0);v(y),D(()=>L(K,c(S).takenSecs)),k(q,y)}),v(V),v(R),v(d),k(a,d)};te(g,a=>{e().length>0&&a(x)})}return k(l,p),_t(m,"fsrsEnabled",h),oe({fsrsEnabled:h})}var la=E('<label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label>'),na=E('<label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label>'),oa=E('<div class="time-range-selector svelte-1niucon"><label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label> <label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label> <!> <!></div>'),va=Ne("<svg><!><!><!></svg>"),ca=E('<div class="forgetting-curve svelte-1niucon"><!> <!></div>');function da(l,m){ne(m,!1);const n=Pt(),e=()=>Kt(d,"$timeRange",n),h=j(),s=j(),o=[];let T=ee(m,"revlog",8),t=ee(m,"desiredRetention",8),r=ee(m,"decay",8),p=j(null);const g=At(),x=dt();let a=j(w.Week);const d=Yt(c(a));U(()=>J(T()),()=>{G(h,Vt(T()))}),U(()=>(c(h),w),()=>{G(s,Ce(c(h),w.AllTime))}),U(()=>(c(s),w),()=>{c(s)>365?G(a,w.AllTime):c(s)>30?G(a,w.Year):c(s)>7&&G(a,w.Month)}),U(()=>c(a),()=>{se(d,c(a))}),U(()=>(c(h),e(),c(p),J(t()),J(r())),()=>{Xt(c(h),e(),c(p),g,t(),r())}),pe(),le();var u=ca(),b=f(u);{var C=$=>{Nt($,{children:(M,A)=>{var i=oa(),F=f(i),N=f(F);de(N);var H,re=_(N);D(()=>{var R;return L(re,` ${(R=ft())!=null?R:""}`)}),v(F);var z=_(F,2),B=f(z);de(B);var X,ve=_(B);D(()=>{var R;return L(ve,` ${(R=mt())!=null?R:""}`)}),v(z);var ae=_(z,2);{var ie=R=>{var W=la(),P=f(W);de(P);var V,q=_(P);D(()=>{var S;return L(q,` ${(S=pt())!=null?S:""}`)}),v(W),D(()=>{V!==(V=w.Year)&&(P.value=(P.__value=w.Year)==null?"":w.Year)}),ue(o,[],P,()=>(w.Year,e()),S=>se(d,S)),k(R,W)};te(ae,R=>{c(s)>30&&R(ie)})}var ge=_(ae,2);{var ce=R=>{var W=na(),P=f(W);de(P);var V,q=_(P);D(()=>{var S;return L(q,` ${(S=gt())!=null?S:""}`)}),v(W),D(()=>{V!==(V=w.AllTime)&&(P.value=(P.__value=w.AllTime)==null?"":w.AllTime)}),ue(o,[],P,()=>(w.AllTime,e()),S=>se(d,S)),k(R,W)};te(ge,R=>{c(s)>365&&R(ce)})}v(i),D(()=>{H!==(H=w.Week)&&(N.value=(N.__value=w.Week)==null?"":w.Week),X!==(X=w.Month)&&(B.value=(B.__value=w.Month)==null?"":w.Month)}),ue(o,[],N,()=>(w.Week,e()),R=>se(d,R)),ue(o,[],B,()=>(w.Month,e()),R=>se(d,R)),k(M,i)},$$slots:{default:!0}})};te(b,$=>{c(s)>7&&$(C)})}var I=_(b,2);kt(I,{title:x,children:($,M)=>{var A=va(),i=f(A);Tt(i,{bounds:g});var F=_(i);Ct(F);var N=_(F);Et(N,{bounds:g}),v(A),It(A,H=>G(p,H),()=>c(p)),D(()=>ut(A,"viewBox",`0 0 ${g.width} ${g.height}`)),k($,A)},$$slots:{default:!0}}),v(u),k(l,u),oe()}var ua=E("<!> <!> <!>",1),fa=E('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Ea(l,m){ne(m,!1);const n=j(),e=j(),h=j();let s=ee(m,"stats",8,null),o=ee(m,"showRevlog",8,!0);U(()=>J(s()),()=>{var r;G(n,((r=s())==null?void 0:r.memoryState)!=null)}),U(()=>J(s()),()=>{var r,p;G(e,(p=(r=s())==null?void 0:r.desiredRetention)!=null?p:.9)}),U(()=>J(s()),()=>{G(h,(()=>{var p,g,x,a,d,u;const r=(x=(g=(p=s())==null?void 0:p.fsrsParams)==null?void 0:g.length)!=null?x:0;return r===0?.2:r<21?.5:(u=(d=(a=s())==null?void 0:a.fsrsParams)==null?void 0:d[20])!=null?u:.2})())}),pe(),le();var T=fa(),t=me(T);ht(t,()=>({"--gutter-inline":"1rem","--gutter-block":"0.5rem"})),bt(t.lastChild,{breakpoint:"md",children:(r,p)=>{var g=Re(),x=me(g);{var a=u=>{var b=ua(),C=me(b);he(C,{children:(i,F)=>{zt(i,{get stats(){return s()}})},$$slots:{default:!0}});var I=_(C,2);{var $=i=>{he(i,{children:(F,N)=>{sa(F,{get revlog(){return s().revlog},get fsrsEnabled(){return c(n)}})},$$slots:{default:!0}})};te(I,i=>{o()&&i($)})}var M=_(I,2);{var A=i=>{he(i,{children:(F,N)=>{da(F,{get revlog(){return s().revlog},get desiredRetention(){return c(e)},get decay(){return c(h)}})},$$slots:{default:!0}})};te(M,i=>{c(n)&&i(A)})}k(u,b)},d=u=>{Wt(u,{})};te(x,u=>{s()?u(a):u(d,!1)})}k(r,g)},$$slots:{default:!0}}),v(t),k(l,T),oe()}export{Ea as C};
