import{P as Xt,c as qt}from"../chunks/BBLiiV7J.js";import{t as B,a as k,c as Mt,s as et,b as Ut}from"../chunks/Bd4FQpE7.js";import{p as nt,c as b,r as y,t as $,a as at,f as rt,x as At,y as Ht,v as J,q as it,k as r,m as j,s as I,A as jt,e as Ct}from"../chunks/Bj8SChEI.js";import{d as Tt,r as kt,a as ot,i as dt,c as gt,s as Wt,b as Gt}from"../chunks/ZhKyHBKW.js";import{s as ht,D as Pt,f as It,F as Et,l as Dt,d as Kt,G as pt,H as wt,J as Jt,L as Qt,M as Nt,T as yt,N as xt,e as ut,c as ct,u as $t,i as Ot,b as te,g as ee}from"../chunks/BAITReer.js";import{S as Lt,f as mt,a as ft,T as ne,A as ae}from"../chunks/CE4fWPWB.js";import"../chunks/4LrpTdiC.js";import{p as oe}from"../chunks/DZz--ybP.js";import{r as Zt}from"../chunks/Cbydd1_z.js";import{S as ie}from"../chunks/BLz4nQPc.js";import{g as se}from"../chunks/YrmfYsvT.js";import{a as re}from"../chunks/DLa1pdXp.js";import{a as Bt}from"../chunks/Cz2nfeI4.js";function le(n){const e=new Map;return n.forEach(o=>{const u=o.annotation_label.annotation_label_name;u&&e.set(u,(e.get(u)||0)+1)}),e}var ue=B("<div><!></div>");function Yt(n,e){nt(e,!0);var o=ue(),u=b(o);ht(u,()=>e.children),y(o),$(f=>Et(o,1,f),[()=>Pt(It("rounded-lg border border-gray-800 bg-black",e.className))]),k(n,o),at()}var ce=B("<div><!></div>");function Ft(n,e){nt(e,!0);var o=ce(),u=b(o);ht(u,()=>e.children),y(o),$(f=>Et(o,1,f),[()=>Pt(It("p-4",e.className))]),k(n,o),at()}function de(n,e){nt(e,!0);let o=kt(e,["$$slots","$$events","$$legacy"]);Dt(n,Tt({name:"move-left"},()=>o,{iconNode:[["path",{d:"M6 8L2 12L6 16"}],["path",{d:"M2 12H22"}]],children:(f,g)=>{var d=Mt(),p=rt(d);ht(p,()=>e.children??At),k(f,d)},$$slots:{default:!0}})),at()}function he(n,e){nt(e,!0);let o=kt(e,["$$slots","$$events","$$legacy"]);Dt(n,Tt({name:"zoom-in"},()=>o,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(f,g)=>{var d=Mt(),p=rt(d);ht(p,()=>e.children??At),k(f,d)},$$slots:{default:!0}})),at()}function me(n,e){nt(e,!0);let o=kt(e,["$$slots","$$events","$$legacy"]);Dt(n,Tt({name:"zoom-out"},()=>o,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(f,g)=>{var d=Mt(),p=rt(d);ht(p,()=>e.children??At),k(f,d)},$$slots:{default:!0}})),at()}var fe=B('<div class="h-full w-full overflow-hidden"><div class="sample relative h-full w-full"><div class="absolute right-4 top-2 z-30"><!></div> <!></div></div>'),ve=B('<div class="flex h-full w-full flex-col space-y-4"><div class="flex w-full items-center space-x-4"><!> <h2 data-testid="sample-filename" class="text-xl font-semibold tracking-tight"> </h2></div> <!> <div class="flex min-h-0 flex-1 gap-4"><div class="flex-1"><!></div> <div class="relative w-[375px]"><!></div></div></div>');function ge(n,e){nt(e,!0);const[o,u]=Wt(),f=()=>gt(w,"$lastGridType",o),g=()=>gt(G,"$selectedSampleAnnotationCropIds",o),d=()=>gt(x,"$selectedSampleIds",o),p=j(()=>{const t=oe.data.annotationId;if(t)return e.sample.annotations.find(i=>i.annotation_id===t)}),{lastGridType:w,selectedSampleIds:x,toggleSampleSelection:M,toggleSampleAnnotationCropSelection:C,selectedSampleAnnotationCropIds:G,getDatasetVersion:O}=Kt();let H=it(""),P=it(!0);Ht(async()=>{var t;(t=e.sample)!=null&&t.dataset_id&&J(H,ot(await O(e.sample.dataset_id)))});const Z=()=>{J(P,!r(P))},c=j(()=>!!r(p));var E=ve(),D=b(E),Y=b(D);const R=j(()=>f()==="samples"?Zt.toSamples(e.sample.dataset_id):Zt.toAnnotations(e.sample.dataset_id));pt(Y,{variant:"outline",get href(){return r(R)},children:(t,i)=>{de(t,{})},$$slots:{default:!0}});var v=I(Y,2),A=b(v);y(v),y(D);var F=I(D,2);Lt(F,{class:"mb-4 bg-border-hard"});var q=I(F,2),S=b(q),K=b(S);Yt(K,{className:"h-full",children:(t,i)=>{Ft(t,{className:"h-full",children:(a,s)=>{var l=fe(),h=b(l),m=b(h),_=b(m);{var z=V=>{const L=j(()=>g().has(r(p).annotation_id));Bt(V,{onSelect:()=>C(r(p).annotation_id),get isSelected(){return r(L)}})},W=V=>{const L=j(()=>d().has(e.sample.sample_id));Bt(V,{onSelect:()=>M(e.sample.sample_id),get isSelected(){return r(L)}})};dt(_,V=>{r(c)&&r(p)?V(z):V(W,!1)})}y(m);var T=I(m,2);const X=j(()=>`${Xt+e.sample.file_path_abs}${r(H)?`?v=${r(H)}`:""}`);Oe(T,{get imageURL(){return r(X)},get annotations(){return e.sample.annotations},get imageWidth(){return e.sample.width},get imageHeight(){return e.sample.height},get showOnlySelectedAnnotation(){return r(P)},get selectedAnnotation(){return r(p)}}),y(h),y(l),k(a,l)},$$slots:{default:!0}})},$$slots:{default:!0}}),y(S);var U=I(S,2),N=b(U);Xe(N,{get sample(){return e.sample},get selectedAnnotation(){return r(p)},get showOnlySelectedAnnotation(){return r(P)},toggleShowOnlySelectedAnnotation:Z}),y(U),y(q),y(E),$(()=>et(A,`Filename: "${e.sample.file_name??""}"`)),k(n,E),at(),u()}var pe=B('<div class="pointer-events-auto absolute bottom-0 left-1 z-20 flex select-none items-center gap-1 rounded-lg bg-muted bg-opacity-80 shadow-md backdrop-blur-sm"><!> <div class="h-6 w-px bg-white bg-opacity-20"></div> <!> <div class="w-[32px] text-center text-sm text-muted-foreground" data-testid="zoom-level"> </div> <!></div>');function _e(n,e){var o=pe(),u=b(o);pt(u,{variant:"ghost","data-testid":"zoom-reset",size:"sm",get onclick(){return e.onZoomReset},get disabled(){return e.isResetDisabled},children:(w,x)=>{jt();var M=Ut("Reset");k(w,M)},$$slots:{default:!0}});var f=I(u,4);pt(f,{title:"zoom out",variant:"ghost",size:"icon","data-testid":"zoom-out",get onclick(){return e.onZoomOut},get disabled(){return e.isZoominDisabled},children:(w,x)=>{me(w,{class:"h-4 w-4"})},$$slots:{default:!0}});var g=I(f,2),d=b(g);y(g);var p=I(g,2);pt(p,{title:"zoom in",variant:"ghost",size:"icon","data-testid":"zoom-in",get onclick(){return e.onZoomIn},get disabled(){return e.isZoomoutDisabled},children:(w,x)=>{he(w,{class:"h-4 w-4"})},$$slots:{default:!0}}),y(o),$(w=>et(d,`${w??""}%`),[()=>Math.round(e.scale*100)]),k(n,o)}function Q(n){return typeof n=="string"?new wt([[document.querySelector(n)]],[document.documentElement]):new wt([[n]],Jt)}function ye(n){let e;for(;e=n.sourceEvent;)n=e;return n}function st(n,e){if(n=ye(n),e===void 0&&(e=n.currentTarget),e){var o=e.ownerSVGElement||e;if(o.createSVGPoint){var u=o.createSVGPoint();return u.x=n.clientX,u.y=n.clientY,u=u.matrixTransform(e.getScreenCTM().inverse()),[u.x,u.y]}if(e.getBoundingClientRect){var f=e.getBoundingClientRect();return[n.clientX-f.left-e.clientLeft,n.clientY-f.top-e.clientTop]}}return[n.pageX,n.pageY]}function xe(n){return new wt([document.querySelectorAll(n)],[document.documentElement])}const zt={capture:!0,passive:!1};function St(n){n.preventDefault(),n.stopImmediatePropagation()}function be(n){var e=n.document.documentElement,o=Q(n).on("dragstart.drag",St,zt);"onselectstart"in e?o.on("selectstart.drag",St,zt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function we(n,e){var o=n.document.documentElement,u=Q(n).on("dragstart.drag",null);e&&(u.on("click.drag",St,zt),setTimeout(function(){u.on("click.drag",null)},0)),"onselectstart"in o?u.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}var ze=1e-12;function Rt(n){return((n=Math.exp(n))+1/n)/2}function Se(n){return((n=Math.exp(n))-1/n)/2}function Me(n){return((n=Math.exp(2*n))-1)/(n+1)}const Ae=function n(e,o,u){function f(g,d){var p=g[0],w=g[1],x=g[2],M=d[0],C=d[1],G=d[2],O=M-p,H=C-w,P=O*O+H*H,Z,c;if(P<ze)c=Math.log(G/x)/e,Z=function(A){return[p+A*O,w+A*H,x*Math.exp(e*A*c)]};else{var E=Math.sqrt(P),D=(G*G-x*x+u*P)/(2*x*o*E),Y=(G*G-x*x-u*P)/(2*G*o*E),R=Math.log(Math.sqrt(D*D+1)-D),v=Math.log(Math.sqrt(Y*Y+1)-Y);c=(v-R)/e,Z=function(A){var F=A*c,q=Rt(R),S=x/(o*E)*(q*Me(e*F+R)-Se(R));return[p+S*O,w+S*H,x*q/Rt(e*F+R)]}}return Z.duration=c*1e3*e/Math.SQRT2,Z}return f.rho=function(g){var d=Math.max(.001,+g),p=d*d,w=p*p;return n(d,p,w)},f}(Math.SQRT2,2,4),vt=n=>()=>n;function Te(n,{sourceEvent:e,target:o,transform:u,dispatch:f}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:u,enumerable:!0,configurable:!0},_:{value:f}})}function bt(n){n.stopImmediatePropagation()}function lt(n){n.preventDefault(),n.stopImmediatePropagation()}function ke(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function Pe(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function Vt(){return this.__zoom||Nt}function Ie(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function Ee(){return navigator.maxTouchPoints||"ontouchstart"in this}function De(n,e,o){var u=n.invertX(e[0][0])-o[0][0],f=n.invertX(e[1][0])-o[1][0],g=n.invertY(e[0][1])-o[0][1],d=n.invertY(e[1][1])-o[1][1];return n.translate(f>u?(u+f)/2:Math.min(0,u)||Math.max(0,f),d>g?(g+d)/2:Math.min(0,g)||Math.max(0,d))}function Ne(){var n=ke,e=Pe,o=De,u=Ie,f=Ee,g=[0,1/0],d=[[-1/0,-1/0],[1/0,1/0]],p=250,w=Ae,x=Qt("start","zoom","end"),M,C,G,O=500,H=150,P=0,Z=10;function c(t){t.property("__zoom",Vt).on("wheel.zoom",F,{passive:!1}).on("mousedown.zoom",q).on("dblclick.zoom",S).filter(f).on("touchstart.zoom",K).on("touchmove.zoom",U).on("touchend.zoom touchcancel.zoom",N).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.transform=function(t,i,a,s){var l=t.selection?t.selection():t;l.property("__zoom",Vt),t!==l?R(t,i,a,s):l.interrupt().each(function(){v(this,arguments).event(s).start().zoom(null,typeof i=="function"?i.apply(this,arguments):i).end()})},c.scaleBy=function(t,i,a,s){c.scaleTo(t,function(){var l=this.__zoom.k,h=typeof i=="function"?i.apply(this,arguments):i;return l*h},a,s)},c.scaleTo=function(t,i,a,s){c.transform(t,function(){var l=e.apply(this,arguments),h=this.__zoom,m=a==null?Y(l):typeof a=="function"?a.apply(this,arguments):a,_=h.invert(m),z=typeof i=="function"?i.apply(this,arguments):i;return o(D(E(h,z),m,_),l,d)},a,s)},c.translateBy=function(t,i,a,s){c.transform(t,function(){return o(this.__zoom.translate(typeof i=="function"?i.apply(this,arguments):i,typeof a=="function"?a.apply(this,arguments):a),e.apply(this,arguments),d)},null,s)},c.translateTo=function(t,i,a,s,l){c.transform(t,function(){var h=e.apply(this,arguments),m=this.__zoom,_=s==null?Y(h):typeof s=="function"?s.apply(this,arguments):s;return o(Nt.translate(_[0],_[1]).scale(m.k).translate(typeof i=="function"?-i.apply(this,arguments):-i,typeof a=="function"?-a.apply(this,arguments):-a),h,d)},s,l)};function E(t,i){return i=Math.max(g[0],Math.min(g[1],i)),i===t.k?t:new yt(i,t.x,t.y)}function D(t,i,a){var s=i[0]-a[0]*t.k,l=i[1]-a[1]*t.k;return s===t.x&&l===t.y?t:new yt(t.k,s,l)}function Y(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function R(t,i,a,s){t.on("start.zoom",function(){v(this,arguments).event(s).start()}).on("interrupt.zoom end.zoom",function(){v(this,arguments).event(s).end()}).tween("zoom",function(){var l=this,h=arguments,m=v(l,h).event(s),_=e.apply(l,h),z=a==null?Y(_):typeof a=="function"?a.apply(l,h):a,W=Math.max(_[1][0]-_[0][0],_[1][1]-_[0][1]),T=l.__zoom,X=typeof i=="function"?i.apply(l,h):i,V=w(T.invert(z).concat(W/T.k),X.invert(z).concat(W/X.k));return function(L){if(L===1)L=X;else{var tt=V(L),_t=W/tt[2];L=new yt(_t,z[0]-tt[0]*_t,z[1]-tt[1]*_t)}m.zoom(null,L)}})}function v(t,i,a){return!a&&t.__zooming||new A(t,i)}function A(t,i){this.that=t,this.args=i,this.active=0,this.sourceEvent=null,this.extent=e.apply(t,i),this.taps=0}A.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,i){return this.mouse&&t!=="mouse"&&(this.mouse[1]=i.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=i.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=i.invert(this.touch1[0])),this.that.__zoom=i,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var i=Q(this.that).datum();x.call(t,this.that,new Te(t,{sourceEvent:this.sourceEvent,target:c,transform:this.that.__zoom,dispatch:x}),i)}};function F(t,...i){if(!n.apply(this,arguments))return;var a=v(this,i).event(t),s=this.__zoom,l=Math.max(g[0],Math.min(g[1],s.k*Math.pow(2,u.apply(this,arguments)))),h=st(t);if(a.wheel)(a.mouse[0][0]!==h[0]||a.mouse[0][1]!==h[1])&&(a.mouse[1]=s.invert(a.mouse[0]=h)),clearTimeout(a.wheel);else{if(s.k===l)return;a.mouse=[h,s.invert(h)],xt(this),a.start()}lt(t),a.wheel=setTimeout(m,H),a.zoom("mouse",o(D(E(s,l),a.mouse[0],a.mouse[1]),a.extent,d));function m(){a.wheel=null,a.end()}}function q(t,...i){if(G||!n.apply(this,arguments))return;var a=t.currentTarget,s=v(this,i,!0).event(t),l=Q(t.view).on("mousemove.zoom",z,!0).on("mouseup.zoom",W,!0),h=st(t,a),m=t.clientX,_=t.clientY;be(t.view),bt(t),s.mouse=[h,this.__zoom.invert(h)],xt(this),s.start();function z(T){if(lt(T),!s.moved){var X=T.clientX-m,V=T.clientY-_;s.moved=X*X+V*V>P}s.event(T).zoom("mouse",o(D(s.that.__zoom,s.mouse[0]=st(T,a),s.mouse[1]),s.extent,d))}function W(T){l.on("mousemove.zoom mouseup.zoom",null),we(T.view,s.moved),lt(T),s.event(T).end()}}function S(t,...i){if(n.apply(this,arguments)){var a=this.__zoom,s=st(t.changedTouches?t.changedTouches[0]:t,this),l=a.invert(s),h=a.k*(t.shiftKey?.5:2),m=o(D(E(a,h),s,l),e.apply(this,i),d);lt(t),p>0?Q(this).transition().duration(p).call(R,m,s,t):Q(this).call(c.transform,m,s,t)}}function K(t,...i){if(n.apply(this,arguments)){var a=t.touches,s=a.length,l=v(this,i,t.changedTouches.length===s).event(t),h,m,_,z;for(bt(t),m=0;m<s;++m)_=a[m],z=st(_,this),z=[z,this.__zoom.invert(z),_.identifier],l.touch0?!l.touch1&&l.touch0[2]!==z[2]&&(l.touch1=z,l.taps=0):(l.touch0=z,h=!0,l.taps=1+!!M);M&&(M=clearTimeout(M)),h&&(l.taps<2&&(C=z[0],M=setTimeout(function(){M=null},O)),xt(this),l.start())}}function U(t,...i){if(this.__zooming){var a=v(this,i).event(t),s=t.changedTouches,l=s.length,h,m,_,z;for(lt(t),h=0;h<l;++h)m=s[h],_=st(m,this),a.touch0&&a.touch0[2]===m.identifier?a.touch0[0]=_:a.touch1&&a.touch1[2]===m.identifier&&(a.touch1[0]=_);if(m=a.that.__zoom,a.touch1){var W=a.touch0[0],T=a.touch0[1],X=a.touch1[0],V=a.touch1[1],L=(L=X[0]-W[0])*L+(L=X[1]-W[1])*L,tt=(tt=V[0]-T[0])*tt+(tt=V[1]-T[1])*tt;m=E(m,Math.sqrt(L/tt)),_=[(W[0]+X[0])/2,(W[1]+X[1])/2],z=[(T[0]+V[0])/2,(T[1]+V[1])/2]}else if(a.touch0)_=a.touch0[0],z=a.touch0[1];else return;a.zoom("touch",o(D(m,_,z),a.extent,d))}}function N(t,...i){if(this.__zooming){var a=v(this,i).event(t),s=t.changedTouches,l=s.length,h,m;for(bt(t),G&&clearTimeout(G),G=setTimeout(function(){G=null},O),h=0;h<l;++h)m=s[h],a.touch0&&a.touch0[2]===m.identifier?delete a.touch0:a.touch1&&a.touch1[2]===m.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),a.taps===2&&(m=st(m,this),Math.hypot(C[0]-m[0],C[1]-m[1])<Z)){var _=Q(this).on("dblclick.zoom");_&&_.apply(this,arguments)}}}return c.wheelDelta=function(t){return arguments.length?(u=typeof t=="function"?t:vt(+t),c):u},c.filter=function(t){return arguments.length?(n=typeof t=="function"?t:vt(!!t),c):n},c.touchable=function(t){return arguments.length?(f=typeof t=="function"?t:vt(!!t),c):f},c.extent=function(t){return arguments.length?(e=typeof t=="function"?t:vt([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),c):e},c.scaleExtent=function(t){return arguments.length?(g[0]=+t[0],g[1]=+t[1],c):[g[0],g[1]]},c.translateExtent=function(t){return arguments.length?(d[0][0]=+t[0][0],d[1][0]=+t[1][0],d[0][1]=+t[0][1],d[1][1]=+t[1][1],c):[[d[0][0],d[0][1]],[d[1][0],d[1][1]]]},c.constrain=function(t){return arguments.length?(o=t,c):o},c.duration=function(t){return arguments.length?(p=+t,c):p},c.interpolate=function(t){return arguments.length?(w=t,c):w},c.on=function(){var t=x.on.apply(x,arguments);return t===x?c:t},c.clickDistance=function(t){return arguments.length?(P=(t=+t)*t,c):Math.sqrt(P)},c.tapDistance=function(t){return arguments.length?(Z=+t,c):Z},c}function Ce(n,e){let o=n.scaleIndependentXForm;o||(o=n.scaleIndependentXForm=e.createSVGTransform(),n.transform.baseVal.appendItem(o));const u=n.parentNode;if(u){const f=u.getScreenCTM();if(f){const g=f.inverse().multiply(e.getScreenCTM());g.e=g.f=0,o.setMatrix(g)}}}var Ge=B('<div class="relative flex h-full w-full select-none items-center justify-center"><!> <svg class="z-10 h-full w-full cursor-grab" preserveAspectRatio="xMidYMid meet"><g><image></image><!></g></svg> <svg class="pointer-events-none absolute inset-0" preserveAspectRatio="xMidYMid meet"></svg></div>');function Oe(n,e){nt(e,!0);let o=it(null),u=it(null),f=it(800),g=it(600);Ct(()=>{if(!r(o))return;J(f,ot(r(o).clientWidth)),J(g,ot(r(o).clientHeight));const v=new ResizeObserver(()=>{r(o)&&(J(f,ot(r(o).clientWidth)),J(g,ot(r(o).clientHeight)))});return v.observe(r(o)),()=>v.disconnect()});const d=j(()=>e.selectedAnnotation&&e.showOnlySelectedAnnotation?[e.selectedAnnotation]:e.annotations),p=10,w=j(()=>{const v={x:0,y:0,width:e.imageWidth,height:e.imageHeight};if(e.selectedAnnotation){const{x:A,y:F,width:q,height:S}=e.selectedAnnotation;return{x:Math.round(Math.max(0,A-p)),y:Math.round(Math.max(0,F-p)),width:Math.round(Math.min(e.imageWidth-A,q+p*2)),height:Math.round(Math.min(e.imageHeight-F,S+p*2))}}return v});let x=it(ot({k:1,x:0,y:0}));const M=j(()=>{if(!r(o))return 1;const v=r(f)/e.imageWidth,A=r(g)/e.imageHeight,F=Math.min(v,A);return r(x).k*F});let C=it(null);const G=()=>{r(o)&&(J(C,ot(Ne().on("zoom",v=>{J(x,ot(v.transform))}).filter(v=>(!v.ctrlKey||v.type==="wheel")&&!v.button&&!(v.type==="mousedown"&&v.button===2)).wheelDelta(v=>-v.deltaY*.002))),Q(r(o)).call(r(C)).on("dblclick.zoom",null))},O=v=>{if(!r(o)||!r(C))return;const A=v?1.5:.75;Q(r(o)).transition().duration(300).call(r(C).scaleBy,A)},H=()=>{!r(o)||!r(C)||Q(r(o)).transition().duration(300).call(r(C).transform,Nt)};Ht(()=>{G()}),Ct(()=>{r(x).k,xe(".unscaled").each(function(){Ce(this,r(u))})});var P=Ge(),Z=b(P);_e(Z,{get scale(){return r(M)},onZoomIn:()=>O(!0),onZoomOut:()=>O(!1),onZoomReset:H});var c=I(Z,2),E=b(c),D=b(E),Y=I(D);ut(Y,17,()=>r(d),v=>v.annotation_id,(v,A)=>{ie(v,{get annotation(){return r(A)},showLabel:!0,get imageWidth(){return e.imageWidth}})}),y(E),y(c),Gt(c,v=>J(o,v),()=>r(o));var R=I(c,2);ct(R,"viewBox","0 0 1024 768"),Gt(R,v=>J(u,v),()=>r(u)),y(P),$(()=>{ct(c,"viewBox",`${r(w).x} ${r(w).y} ${r(w).width} ${r(w).height}`),ct(E,"transform",`translate(${r(x).x}, ${r(x).y}) scale(${r(x).k})`),ct(D,"href",e.imageURL)}),k(n,P),at()}var Ze=B('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),Be=B('<div class="flex flex-col gap-4"><!> <div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div></div>'),Re=B("<div> </div>"),Ve=B('<div class="flex gap-1"></div>'),He=B('<div class="flex items-center justify-between gap-2 rounded-sm bg-card px-5 py-2"><div class="text-sm"> </div> <div class="text-sm"> </div></div>'),We=B('<div class="flex flex-col gap-2"></div>'),Le=B('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),Ye=B('<div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div>'),Fe=B('<div class="flex-none"><div class="mb-2.5 text-lg font-semibold">Sample details</div> <!></div> <div class="flex h-full min-h-0 flex-col space-y-2 overflow-y-auto dark:[color-scheme:dark]"><!> <!> <!> <!></div>',1);function Xe(n,e){nt(e,!0);const[o,u]=Wt(),f=()=>gt(g,"$taskMap",o),{taskMap:g}=$t(),d=e.sample.tags,p=le(e.sample.annotations),w=j(()=>e.selectedAnnotation&&e.selectedAnnotation.annotation_task_id&&f().has(e.selectedAnnotation.annotation_task_id)?f().get(e.selectedAnnotation.annotation_task_id).is_prediction:!1),x=[{label:"Height:",value:mt(e.sample.height)+"px"},{label:"Width:",value:mt(e.sample.width)+"px"},{label:"Filename:",value:e.sample.file_name},{label:"Filepath:",value:e.sample.file_path_abs}],M=j(()=>e.selectedAnnotation?[{label:"Height:",value:mt(Math.round(e.selectedAnnotation.height))+"px"},{label:"Width:",value:mt(Math.round(e.selectedAnnotation.width))+"px"},{label:"Annotation:",value:e.selectedAnnotation.annotation_label.annotation_label_name},{label:"Type:",value:"Bounding box"},{label:"Status:",value:r(w)?"Prediction":"Ground Truth"}]:[]);Yt(n,{className:"h-full",children:(C,G)=>{Ft(C,{className:"h-full flex flex-col",children:(O,H)=>{var P=Fe(),Z=rt(P),c=I(b(Z),2);Lt(c,{class:"mb-4 bg-border-hard"}),y(Z);var E=I(Z,2),D=b(E);{var Y=S=>{ft(S,{title:"Selected annotation",children:(K,U)=>{var N=Be(),t=b(N);re(t,{name:"show-all",label:"Show only selected annotation",get isChecked(){return e.showOnlySelectedAnnotation},helperText:"Hides other annotations for clarity.",get onCheckedChange(){return e.toggleShowOnlySelectedAnnotation}});var i=I(t,2);ut(i,21,()=>r(M),({label:a,value:s})=>a,(a,s)=>{let l=()=>r(s).label,h=()=>r(s).value;var m=Ze(),_=rt(m),z=b(_,!0);y(_);var W=I(_,2),T=b(W,!0);y(W),$(()=>{et(z,l()),et(T,h())}),k(a,m)}),y(i),y(N),k(K,N)}})};dt(D,S=>{e.selectedAnnotation&&S(Y)})}var R=I(D,2);{var v=S=>{ft(S,{title:"Tags",icon:ne,children:(K,U)=>{var N=Ve();ut(N,21,()=>d,Ot,(t,i)=>{var a=Re(),s=b(a,!0);y(a),$(l=>{Et(a,1,l),et(s,r(i).name)},[()=>Pt(It("inline rounded-lg bg-card px-2 py-2 text-xs"))]),k(t,a)}),y(N),k(K,N)}})};dt(R,S=>{d.length>0&&S(v)})}var A=I(R,2);{var F=S=>{ft(S,{title:"Annotations",children:(K,U)=>{var N=We();ut(N,21,()=>p,Ot,(t,i)=>{var a=He(),s=b(a),l=b(s,!0);y(s);var h=I(s,2),m=b(h);y(h),y(a),$(_=>{et(l,r(i)[0]),te(h,`color: ${_??""};`),et(m,`(${r(i)[1]??""})`)},[()=>se(r(i)[0]).color]),k(t,a)}),y(N),k(K,N)}})};dt(A,S=>{p.size>0&&S(F)})}var q=I(A,2);ft(q,{title:"Metadata",children:(S,K)=>{var U=Ye();ut(U,21,()=>x,({label:N,value:t})=>N,(N,t)=>{let i=()=>r(t).label,a=()=>r(t).value;var s=Le(),l=rt(s),h=b(l,!0);y(l);var m=I(l,2),_=b(m,!0);y(m),$(()=>{et(h,i()),et(_,a())}),k(N,s)}),y(U),k(S,U)}}),y(E),k(O,P)},$$slots:{default:!0}})},$$slots:{default:!0}}),at(),u()}const qe=async({sample_id:n})=>{const e={data:void 0,error:void 0};try{const o=await qt.GET("/api/samples/{sample_id}",{params:{path:{sample_id:n}}});if(o.error)throw new Error(JSON.stringify(o.error,null,2));if(!o.data)throw new Error("No data");e.data=o.data}catch(o){e.error="Error loading sample: "+String(o)}return e},Ue=async({params:n,url:e})=>{const{sample_id:o}=n,{data:u,error:f}=await qe({sample_id:o});return{sample:u,annotationId:e.searchParams.get("annotationId"),error:f}},hn=Object.freeze(Object.defineProperty({__proto__:null,load:Ue},Symbol.toStringTag,{value:"Module"}));var je=B("<a>Go home</a>"),Ke=B('<div class="flex h-full w-full space-x-4 px-4 pb-4"><div class="h-full w-full space-y-6 rounded-[1vw] bg-card p-4"><!></div></div>');function mn(n,e){nt(e,!0);const o=ee(),[u,f]=o;var g=Ke(),d=b(g),p=b(d);{var w=M=>{ge(M,{get sample(){return e.data.sample}})},x=M=>{ae(M,{title:"Sample not found",children:(C,G)=>{var O=je();$(H=>ct(O,"href",H),[()=>u("/",void 0)]),k(C,O)}})};dt(p,M=>{e.data.sample?M(w):M(x,!1)})}y(d),y(g),k(n,g),at()}export{mn as component,hn as universal};
