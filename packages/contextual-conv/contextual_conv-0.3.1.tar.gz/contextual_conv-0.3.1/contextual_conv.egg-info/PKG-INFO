Metadata-Version: 2.4
Name: contextual-conv
Version: 0.3.1
Summary: PyTorch convolutional layers with global context conditioning
Author-email: Mehdi Abbassi <mehdi.n.abbassi@gmail.com>
License: GPL-3.0-only
Project-URL: Homepage, https://github.com/abbassix/ContextualConv
Requires-Python: >=3.7
Description-Content-Type: text/markdown
License-File: LICENSE
Provides-Extra: dev
Requires-Dist: pytest; extra == "dev"
Requires-Dist: torch; extra == "dev"
Dynamic: license-file

# ContextualConvÂ Â 

[![PyPI version](https://img.shields.io/pypi/v/contextual-conv)](https://pypi.org/project/contextual-conv/)
[![CI](https://github.com/abbassix/ContextualConv/actions/workflows/test.yml/badge.svg?branch=main)](https://github.com/abbassix/ContextualConv/actions/workflows/test.yml)
[![Docs](https://readthedocs.org/projects/contextualconv/badge/?version=latest)](https://contextualconv.readthedocs.io/en/latest/)
[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)

> **ContextualConv** â€“ PyTorch convolutional layers with **global context conditioning**: perâ€‘channel **bias**, **scale**, or **FiLMâ€‘style**Â *scaleÂ +Â bias*.

---

## ğŸš€Â Quick start

```python
from contextual_conv import ContextualConv2d
import torch

# FiLMâ€‘style (scale + bias)
conv = ContextualConv2d(
    in_channels=16,
    out_channels=32,
    kernel_size=3,
    padding=1,
    context_dim=10,   # size of global vector c
    h_dim=64,         # optional MLP hidden dim
    use_scale=True,   # Î³(c)
    use_bias=True     # Î²(c)
)

x = torch.randn(8, 16, 32, 32)  # feature map
c = torch.randn(8, 10)          # context vector

out = conv(x, c)  # shape: (8, 32, 32, 32)
```

### Modes at a glance
| `use_scale` | `use_bias` | Behaviour |
|-------------|-----------|-----------|
| `False`     | `True`    | **Contextual bias** (original behaviour) |
| `True`      | `False`   | **Perâ€‘channel scale** only |
| `True`      | `True`    | **FiLM**Â â€“ scale **and** bias |

If *both* flags are `False`, the constructor raises `ValueError`.

---

## ğŸ”§Â Key features

* âš™ï¸Â **Dropâ€‘in replacement** for `nn.Conv1d` / `nn.Conv2d`  
  â†’ Same arguments + optional context options.
* ğŸ§ Â **Global vector conditioning** via learnable Î³(c) and/or Î²(c).
* ğŸª¶Â **Lightweight** â€“ one small MLP (or single `Linear`) per layer.
* ğŸ§‘â€ğŸ”¬Â **FiLM ready** â€“ reproduce Featureâ€‘wise Linear Modulation with two lines.
* ğŸ§©Â **Modular** â€“ combine with any architecture, works on CPU / GPU.
* âœ…Â **Unitâ€‘tested** and documented.

---

## ğŸ“¦Â Installation

```bash
pip install contextual-conv  # version 0.3.0 on PyPI
```

Or install from source:

```bash
git clone https://github.com/abbassix/ContextualConv.git
cd ContextualConv
pip install -e .[dev]
```

---

## ğŸ“Â Context vector details

* Shape: **`(B, context_dim)`**  
  (one global descriptor per sample â€“ class label embedding, latent code, etc.)
* Processed by a **`ContextProcessor`**:
  * `Linear(context_dim, out_dim)` *(biasâ€‘only / scaleâ€‘only)*
  * Small **MLP** if `h_dim` is set.
* Output dims:
  * `out_channels` â†’ bias **or** scale
  * `2 Ã— out_channels` â†’ FiLM (scaleÂ +Â bias)

---

## ğŸ§ªÂ Running tests

```bash
pytest tests/
```

---

## ğŸ“˜Â Documentation

Full API reference & tutorials: **<https://contextualconv.readthedocs.io>**

---

## ğŸ¤Â Contributing

Bug reports, feature requests, and PRs are welcome! See `CONTRIBUTING.md`.

---

## ğŸ“„Â License

GNU GPLv3 â€“ see `LICENSE` file for details.

