Metadata-Version: 2.4
Name: collective.messagesviewlet
Version: 1.0b4
Summary: Add-on displaying manager defined messages in a viewlet
Home-page: http://pypi.python.org/pypi/collective.messagesviewlet
Author: IMIO Team
Author-email: support@imio.be
License: GPL version 2
Keywords: Python Plone
Classifier: Environment :: Web Environment
Classifier: Framework :: Plone
Classifier: Framework :: Plone :: 4.3
Classifier: Framework :: Plone :: 5.1
Classifier: Framework :: Plone :: 5.2
Classifier: Framework :: Plone :: 6.0
Classifier: Framework :: Plone :: 6.1
Classifier: Framework :: Plone :: Addon
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 2.7
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Operating System :: OS Independent
Classifier: License :: OSI Approved :: GNU General Public License v2 (GPLv2)
Requires-Dist: collective.behavior.talcondition
Requires-Dist: setuptools
Provides-Extra: test
Requires-Dist: plone.app.testing; extra == "test"
Requires-Dist: plone.app.robotframework[debug]; extra == "test"
Requires-Dist: robotframework-selenium2screenshots; extra == "test"
Provides-Extra: plone4
Requires-Dist: plone.api; extra == "plone4"
Requires-Dist: plone.app.contenttypes; extra == "plone4"
Requires-Dist: plone.app.dexterity; extra == "plone4"
Requires-Dist: plone.app.lockingbehavior; extra == "plone4"
Requires-Dist: plone.formwidget.datetime>=1.2; extra == "plone4"
Requires-Dist: plone.app.event; extra == "plone4"
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: home-page
Dynamic: keywords
Dynamic: license
Dynamic: provides-extra
Dynamic: requires-dist
Dynamic: summary

.. image:: https://github.com/collective/collective.messagesviewlet/actions/workflows/plone-package-test.yml/badge.svg?branch=master
    :target: https://github.com/collective/collective.messagesviewlet/actions/workflows/plone-package-test.yml

.. image:: https://coveralls.io/repos/collective/collective.messagesviewlet/badge.svg?branch=master
  :target: https://coveralls.io/github/collective/collective.messagesviewlet?branch=master

.. image:: http://img.shields.io/pypi/v/collective.messagesviewlet.svg
   :alt: PyPI badge
   :target: https://pypi.org/project/collective.messagesviewlet


.. This README is meant for consumption by humans and pypi. Pypi can render rst files so please do not use Sphinx features.
   If you want to learn more about writing documentation, please check out: http://docs.plone.org/about/documentation_styleguide_addons.html
   This text does not appear on pypi or github. It is a comment.

==============================================================================
collective.messagesviewlet
==============================================================================

Add-on displaying manager defined messages in a viewlet

.. image:: https://raw.githubusercontent.com/collective/collective.messagesviewlet/master/docs/messageviewletinaction.png
    :alt: The three message types.
    :width: 1300
    :align: center

Features
--------

Messages are defined in control panel.

Multiple messages can be displayed together in the viewlet.

A message contains the following configuration attributes:

* text : displayed text in the viewlet
* message type : info, significant, warning (different layout in the viewlet)
* can hide : if checked, the user can hide the message (mark as read)
* start date : displaying start date (optional)
* end date : displaying end date (optional)
* required roles : user must have one of the required roles (optional)
* use local roles : message displayed for users having Reader local role on message (optional)
* location : full site or homepage only

Local messages can also be authorized (through control panel) to be added in any
folderish content types and you can then choose if / on which levels they display.

The collective.behavior.talcondition is enabled, providing 2 attributes.

* tal condition : optional tal expression evaluated on viewlet context
* bypassing roles : optional roles bypassing the tal condition

.. image:: https://raw.githubusercontent.com/collective/collective.messagesviewlet/master/docs/messageviewletinconfiguration.png
    :alt: The management interface.
    :width: 1252
    :align: center


A workflow is provided with the following states:

* inactive : not displayed
* activated : displayed

The hiding functionality uses a cookie. It is necessary to (re-)activate a message to "reset" the cookie.
After new activation, the message will be displayed again even for users that hide it.

The optional 'messages' profile adds some usefull examples that can be activated when needed:

* message for scheduled maintenance (limited to Member)
* message for imminent or current maintenance : (given to anonymous)
* message for staging site

There is also a PseudoMessage class that can be instantiated and used in viewlet templates.


Limitations
-----------

This add-on has been developed on Plone 4.3, but works with Plone 5 and Plone 6 too.

Current branch is tested on:

* Python 2.7 / Plone 4.3.x & Plone 5.1.x
* Python 3.7 / Plone 5.2.x
* Python 3.8 / Plone 5.2.x & Plone 6.0.x


Improvements
------------

* Modify hidden_uid when some fields are changed: end when gone, can_hide (to unchecked), start when end is gone
* Message definition from file system
* Message definition from rss feed


Translations
------------

This product has been translated into

- English
- French


Installation
------------

Install collective.messagesviewlet by adding it to your buildout::

   [buildout]

    ...

    eggs =
        collective.messagesviewlet


and then running "bin/buildout"


Contribute
----------

- Issue Tracker: https://github.com/collective/collective.messagesviewlet/issues
- Source Code: https://github.com/collective/collective.messagesviewlet


Support
-------

If you are having issues, please let us know.


License
-------

The project is licensed under the GPLv2.

Contributors
============

- IMIO Team, support@imio.be

Changelog
=========


1.0b4 (2025-04-24)
------------------

- Add Plone 6.1 compatibility by replacing pkg_resources with importlib
  [remdub]


1.0b3 (2023-08-24)
------------------

- Add upgrade step : Remove deprecated control panel action
  [boulch]

- Improve uninstall product
  [boulch, gbastien]


1.0b2 (2022-12-26)
------------------

- Fix bundle registry upgrade step
  [laulaz]


1.0b1 (2022-12-22)
------------------

- Migrate to Plone 6.0.0: remove dexteritytextindexer, use new simplified
  resources registry, fix styles, fix icons, ...
  [boulch, laulaz]
- Add local messages feature. Local messages can be added in any folderish
  content types and you can choose if / on which levels they display.
  [boulch]
- Protect messages-config folder with one-state private workflow.
  [boulch]
- Add control panel (with messages-config folder link).
  [boulch]
- Use JS to show/hide messages when closed, to avoid caching problems (#12).
  [laulaz]
- Update / improve translations.
  [boulch, laulaz]


0.23 (2020-04-17)
-----------------
- Fix tests & travis build (#8).
  [laulaz]
- Prevent a bug when compare 2 dates with different timezone format.
  [boulch]


0.22 (2020-01-15)
-----------------

- Fix bug when message configuration don't permit to hide this message (close button stayed).
  [boulch]
- Adapted code for Plone5.2/Py3.
  [gbastien]

0.21 (2019-10-14)
-----------------

- Bypass allowed content types contraint when (post)install messagesConfig container
  [boulch]


0.20 (2019-08-23)
-----------------

- Added parameter `caching=True` to `utils.get_messages_to_show`, if `True`,
  the method result is cached in the request for given `context`.
  [gbastien]

0.19 (2019-07-15)
-----------------

- Added PseudoMessage class that be be used in viewlet template.
  [sgeulette]

0.18 (2019-05-27)
-----------------

- Define version to `2000` in `metadata.xml` of plone4 profile or upgrade step
  to 2000 is always displayed.
  [gbastien]

0.17 (2019-04-23)
-----------------

- Evaluate TAL condition using behavior `evaluate` method instead calling
  directly submethod `utils.evaluateExpressionFor` so behavior method
  `complete_extra_expr_ctx` is called.
  [gbastien]
- Call JS on portal_url so it can be cached by the browser.
  [gbastien]
- Tests on Plone5 and Plone4.
  [bsuttor]
- Manage profiles differently
  [sgeulette]
- Moved `MessagesViewlet.getAllMessages` code to `utils.get_messages_to_show`
  so it is easily callable from outside.
  [gbastien]
- Be defensive while managing TZ of message dates : do not set it if already
  set, it fails, moreover, indexing a metadata from a date attribute that had
  no TZ to one having TZ fails so undindex/reindex the entire message.
  [gbastien]

0.16 (2018-10-18)
-----------------

- Corrected import step dependencies to avoid unresolved warning. Save really changes !
  [sgeulette]

0.15 (2018-10-11)
-----------------

- Corrected import step dependencies to avoid unresolved warning.
  [sgeulette]

0.14 (2018-07-23)
-----------------

- Generate new uid when message is activated or re-activated.
  [sgeulette]

0.13 (2018-06-13)
-----------------

- Add <span> around cross <img> to ease override.
  [mgennart]

0.12 (2017-05-30)
-----------------

- Corrected image path.
  [sgeulette]
- Decrease space between messages
  [sgeulette]

0.11 (2017-03-16)
-----------------

- Added default message to warn that application only runs correctly on Firefox
  and Chrome, in addition to the already existing message that warned about the
  application only running correctly on Firefox.
  [gbastien]
- Use CheckBoxWidget for IMessage.required_roles` to ease selection when
  displaying several elements.
  [gbastien]
- Use RadioFieldWidget for Bool fields `IMessage.can_hide` and
  `IMessage.use_local_roles` so it is displayed correctly on the view,
  especially when it is False.
  [gbastien]


0.10 (2017-02-06)
-----------------

- Use INavigationRoot instead of IPloneSiteRoot to check if context is homepage.
  [bsuttor]


0.9 (2016-03-30)
----------------

- Increased coverage by using vocabulary methods instead of redefining it in tests.
  [gbastien]
- Added new example message: bad browser (not Firefox) warning
  [sgeulette]
- Use plone.formwidget.datetime to have hour at 0 by default.
  [sgeulette]
- CSS fix : display 'cursor: pointer;' when hovering the close button.
  [gbastien]
- Added 'MessagesConfig' to site_properties.types_not_searched.
  [gbastien]


0.8 (2016-01-18)
----------------

- Added parameter 'activate' to utils.add_message that makes it possible to create
  an 'activated' message directly.
  [gbastien]
- Adapted tests to use utils.add_message instead of duplicating this code.
  [gbastien]


0.7 (2015-11-17)
----------------

- Do not pass a default 'context' in utils._ to avoid strange ConnectionStateError.
  [gbastien]
- Give context to translate method.
  [sgeulette]
- Corrected and added icon type images.
  [sgeulette]


0.6 (2015-09-18)
----------------

- Simplify workflow. Only one activated state. Unrestricted search results before filtering.
  Added 'use local role' boolean attribute.
  [sgeulette]
- Updated default messages
  [sgeulette]
- Added local roles test
  [sgeulette]
- Renamed bad transition name
  [sgeulette]


0.5 (2015-09-14)
----------------

- Removed useless dependency on z3c.jbot.
  [gbastien]
- Corrected rst in readme.
  [sgeulette]


0.4 (2015-09-10)
----------------

- Use full url for readme images to display correctly on pypi.
  [sgeulette]


0.3 (2015-09-10)
----------------

- Translate title configuration folder.
  [sgeulette]


0.2 (2015-09-09)
----------------

- Added utils method to create message. Added example profile to add some messages.
  [sgeulette]


0.1 (2015-09-08)
----------------

- Initial release.
  [sgeulette, anuyens, DieKatze, boulch]

