
# üöÄ Py Dir Sync

    pip install py-dir-sync

–ü—Ä–æ—Å—Ç–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Python –¥–ª—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π _–∂–∏–≤–æ–π_ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–∞—Ç–∞–ª–æ–≥–æ–≤. –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ `source` –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö –∫ —Ü–µ–ª–µ–≤–æ–º—É –∫–∞—Ç–∞–ª–æ–≥—É `destination`, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π.

![](./py_dir_sync_demo.gif)

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* **–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –∏–∑ `source` –≤ `destination`.
* **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** –ì–∏–±–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫ —á–µ—Ä–µ–∑ –ø–∞—Ç—Ç–µ—Ä–Ω—ã `fnmatch`.
* **–°–æ–±—ã—Ç–∏—è:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã, –∏–∑–º–µ–Ω–µ–Ω—ã, –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –∏–ª–∏ —É–¥–∞–ª–µ–Ω—ã —á–µ—Ä–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `ChangeHandler`.
* **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
    *   –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `auto_sync=True`.
    *   –£–¥–∞–ª–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ `dest` `remove_empty=True`.
    *   –§–æ—Ä—Å-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ø—ã—Ç–æ–∫ `force_sync=5` –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ `force_sync_interval=1`.
* **–û—Å–Ω–æ–≤–∞–Ω –Ω–∞** [`watchdog`](https://github.com/gorakhargosh/watchdog)
* **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Python **3.12**+.

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä [py_dir_sync_run.py](./py_dir_sync_run.py), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö.

```py
from pathlib import Path, PurePath
from typing import AbstractSet
from py_dir_sync import DirSync, SyncPathPair

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–∂–µ—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å,
# –Ω–æ DirSync —Ç—Ä–µ–±—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é ChangeHandler(Protocol)
def handler(
    created: None | set[Path] = None,
    modified: None | set[Path] = None,
    moved: None | AbstractSet[tuple[PurePath, Path]] = None,
    deleted: None | AbstractSet[PurePath] = None,
    error: None | Exception = None,
) -> None:
    pass

# –ü–∞—Ä–∞ –ø—É—Ç–µ–π –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
path_pair = SyncPathPair("C:/src", "C:/dest")

# –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è src)
# include –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ —Ñ–∞–π–ª–∞–º –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ exclude.
exclude = [".*", "*/.*"]
include = ["*.py", "*.json", "*.md", "*.txt"]

# –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ DirSync
dir_sync = DirSync(
      handler=handler,
      path_pair=path_pair,
      exclude=exclude,
      include=include,
      auto_sync=True,    # —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ start()
      remove_empty=True, # —É–¥–∞–ª—è—Ç—å –ø—É—Å—Ç—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏
      force_sync=3, # –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥(3 –ø–æ–ø—ã—Ç–∫–∏)
      force_sync_interval=2, # 2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
  ) 

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –Ω–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
dir_sync.start()

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —è–≤–Ω–æ
dir_sync.stop()
```

**–ü–∞—Ç—Ç–µ—Ä–Ω—ã exclude/include**

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å [fnmatch](https://docs.python.org/3/library/fnmatch.html).
* `exclude` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–≤–æ–π, –∑–∞—Ç–µ–º `include` –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ —Ñ–∞–π–ª–∞–º.
* –ü—É—Ç—å –≤—Å–µ–≥–¥–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `source`-–∫–∞—Ç–∞–ª–æ–≥–∞.

**auto_sync**

* –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∫–∞—Ç–∞–ª–æ–≥–∏ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `DirSync.start()`

**remove_empty**

* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å –Ω–∞—Ü–µ–ª–µ–Ω –Ω–∞ —Å–æ–±—ã—Ç–∏—è —Ñ–∞–π–ª–æ–≤, –∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —Å—Ç–æ–∏—Ç –ª–∏ —É–¥–∞–ª—è—Ç—å –ø—É—Å—Ç—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.
* –û–ø—Ü–∏—è `remove_empty=True` –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–ª–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤/–∫–∞—Ç–∞–ª–æ–≥–æ–≤.
* –ï—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –æ–∫–∞–∂–µ—Ç—Å—è –ø—É—Å—Ç–æ–π, –æ–Ω–∞ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞.

**force_sync/force_sync_interval**

* –õ—é–±–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ–±—ã—Ç–∏–π –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—à–∏–±–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è/–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `error` –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ `ChangeHandler(error:Exception)`.
* –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —É–∫–∞–∂–∏—Ç–µ:
  + `force_sync > 0` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—ã–∑–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é.
  + `force_sync_interval = 1` (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö, –º–æ–∂–Ω–æ float) ‚Äî –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏.
